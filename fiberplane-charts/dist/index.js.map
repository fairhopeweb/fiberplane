{"version":3,"file":"index.js","sources":["../src/theme/chartThemeContext.ts","../src/BaseComponents/ButtonGroup.tsx","../src/BaseComponents/Containers.tsx","../src/BaseComponents/Controls.tsx","../src/BaseComponents/Icon/icons/ChartBar.svg","../src/BaseComponents/Icon/icons/ChartLine.svg","../src/BaseComponents/Icon/icons/Check.svg","../src/BaseComponents/Icon/icons/Combined.svg","../src/BaseComponents/Icon/icons/Percentage.svg","../src/BaseComponents/Icon/icons/Stacked.svg","../src/BaseComponents/Icon/icons/TriangleDown.svg","../src/BaseComponents/Icon/IconMap.ts","../src/BaseComponents/Icon/Icon.tsx","../src/BaseComponents/IconButton.tsx","../src/utils/compact.ts","../src/utils/findUniqueKeys.ts","../src/utils/identity.ts","../src/utils/mergeRefs.ts","../src/utils/noop.ts","../src/utils/preventDefault.ts","../src/utils/sortBy.ts","../src/utils/timestamps.ts","../src/utils/useragent.ts","../src/MetricsChart/ChartControls.tsx","../src/CoreChart/ChartSizeContext.ts","../src/hooks/useHandler.ts","../src/hooks/useExpandable.tsx","../src/hooks/useForceUpdate.ts","../src/hooks/useIntersectionObserver.ts","../src/hooks/useMeasure.ts","../src/CoreChart/ChartSizeContainerProvider.tsx","../src/CoreChart/ChartShape/paths/utils.ts","../src/CoreChart/ChartShape/paths/createAreaPathDef.ts","../src/CoreChart/ChartShape/paths/createLinePathDef.ts","../src/CoreChart/ChartShape/AreaShape.tsx","../src/CoreChart/ChartShape/LineShape.tsx","../src/CoreChart/constants.ts","../src/CoreChart/ChartShape/PointShape.tsx","../src/CoreChart/ChartShape/RectangleShape.tsx","../src/CoreChart/ChartShape/ChartShape.tsx","../src/CoreChart/ChartContent.tsx","../src/CoreChart/GridWithAxes/BottomAxis.tsx","../src/CoreChart/utils.ts","../src/CoreChart/GridWithAxes/GridColumns.tsx","../src/CoreChart/GridWithAxes/GridRows.tsx","../src/CoreChart/GridWithAxes/LeftAxis.tsx","../src/CoreChart/GridWithAxes/GridWithAxes.tsx","../src/CoreChart/hooks/useInteractiveControls.ts","../src/CoreChart/hooks/useMouseControls.ts","../src/CoreChart/hooks/useScales.ts","../src/CoreChart/hooks/useTooltip.ts","../src/CoreChart/ZoomBar.tsx","../src/CoreChart/CoreChart.tsx","../src/Mondrian/generator/utils/getTimeFromTimestamp.ts","../src/Mondrian/generator/utils/attachSuggestionsToXAxis.ts","../src/Mondrian/generator/constants.ts","../src/Mondrian/generator/utils/calculateBarWidth.ts","../src/Mondrian/generator/utils/calculateBarX.ts","../src/Mondrian/generator/utils/extendMinMax.ts","../src/Mondrian/generator/utils/getInitialMinMax.ts","../src/Mondrian/generator/utils/getYAxisForConstantValue.ts","../src/Mondrian/generator/utils/calculateStackedYAxisRange.ts","../src/Mondrian/generator/utils/createMetricBuckets.ts","../src/Mondrian/generator/utils/getXAxisFromTimeRange.ts","../src/Mondrian/generator/utils/calculateBucketsAndAxesForStackedChart.ts","../src/Mondrian/generator/utils/calculateSmallestTimeInterval.ts","../src/Mondrian/generator/utils/calculateYAxisRange.ts","../src/Mondrian/generator/utils/extendAxisWithInterval.ts","../src/Mondrian/generator/utils/extendAxisWithValue.ts","../src/Mondrian/generator/utils/normalizeAlongLinearAxis.ts","../src/Mondrian/generator/utils/splitIntoContinuousLines.ts","../src/Mondrian/generator/generateBarChartFromTimeseries.ts","../src/Mondrian/generator/generateLineChartFromTimeseries.ts","../src/Mondrian/generator/generateShapeListFromEvents.ts","../src/Mondrian/generator/generateShapeListFromTargetLatency.ts","../src/Mondrian/generator/generateStackedBarChartFromTimeseries.ts","../src/Mondrian/generator/generateStackedLineChartFromTimeseries.ts","../src/Mondrian/generator/index.ts","../src/TimeseriesLegend/TimeseriesLegendItem.tsx","../src/TimeseriesLegend/TimeseriesLegend.tsx","../src/MetricsChart/MetricsChart.tsx","../src/SparkChart/SparkChart.tsx","../src/tickFormatters.ts"],"sourcesContent":["import { createContext } from \"react\";\nimport { Theme } from \"../chartThemeTypes\";\n\nexport const defaultChartTheme: Theme = {\n  axisColor: \"#a4a4a4\",\n  axisFontFamily: \"inherit\",\n  axisFontSize: \"12px\",\n  axisFontStyle: \"normal\",\n  axisFontWeight: \"400\",\n  axisLetterSpacing: \"inherit\",\n  buttonActiveBackgroundColor: \"#606266\",\n  buttonActiveColor: \"white\",\n  buttonBackgroundColor: \"transparent\",\n  buttonBorderRadius: \"6px\",\n  buttonColor: \"#1f2023\",\n  buttonDisabledBackgroundColor: \"transparent\",\n  buttonDisabledColor: \"#a4a4a4\",\n  buttonFocusBackgroundColor: \"white\",\n  buttonFocusBorderColor: \"#285fff\",\n  buttonFocusColor: \"#606266\",\n  buttonFocusOutline: \"rgb(183, 201, 255) solid 2px\",\n  buttonFont: \"normal 600 14px / 16px sans-serif\",\n  buttonGroupBackgroundColor: \"#f3f3f3\",\n  buttonGroupBorderRadius: \"6px\",\n  buttonHoverBackgroundColor: \"#e7e7e7\",\n  buttonHoverColor: \"#1f2023\",\n  eventColor: \"#285fff\",\n  expandableGradientColor: \"rgb(255 255 255 / 75%)\",\n  gridStrokeColor: \"#e7e7e7\",\n  legendItemBorderRadius: \"6px\",\n  legendItemCheckboxBorderRadius: \"4px\",\n  legendItemCheckboxColor: \"#285fff\",\n  legendItemColor: \"black\",\n  legendItemEmphasisBackgroundColor: \"#f3f3f3\",\n  legendItemEmphasisBorderRadius: \"4px\",\n  legendItemEmphasisColor: \"black\",\n  legendItemEmphasisFont: \"inherit\",\n  legendItemFont: \"inherit\",\n  legendItemOnHoverBackgroundColor: \"#a4a4a4\",\n  legendItemOnHoverColor: \"inherit\",\n  legendResultsColor: \"inherit\",\n  legendResultsFont: \"inherit\",\n  legendResultsLetterSpacing: \"inherit\",\n  shapeListColors: [\"#c00eae\", \"#23304a\", \"#cf3411\"],\n  targetLatencyColor: \"inherit\",\n};\n\nexport const ChartThemeContext = createContext<Theme>(defaultChartTheme);\n","import { useContext } from \"react\";\nimport styled, { css } from \"styled-components\";\n\nimport { ChartThemeContext } from \"../theme\";\n\nexport const ButtonGroup = styled.span(() => {\n  const theme = useContext(ChartThemeContext);\n\n  return css`\n    display: flex;\n    gap: 8px;\n    align-items: center;\n    padding: 4px 8px;\n    background: ${theme.buttonGroupBackgroundColor};\n    border-radius: ${theme.buttonGroupBorderRadius};\n  `;\n});\n","import styled from \"styled-components\";\n\nexport const Box = styled.div`\n  box-sizing: border-box;\n  margin: 0;\n  min-width: 0;\n`;\n\nexport const Container = styled(Box)`\n  display: flex;\n`;\n","import { useContext } from \"react\";\nimport styled, { css } from \"styled-components\";\n\nimport { ChartThemeContext } from \"../theme\";\n\nexport const ControlsContainer = styled.div`\n  display: flex;\n  margin: 0 0 12px;\n  gap: 24px;\n`;\n\nexport const ControlsGroup = styled.div`\n  display: flex;\n  gap: 8px;\n`;\n\nexport const ControlsSet = styled.div`\n  display: flex;\n  gap: 8px;\n  align-items: center;\n`;\n\nexport const ControlsSetLabel = styled.span(() => {\n  const theme = useContext(ChartThemeContext);\n\n  return css`\n    font: ${theme.buttonFont};\n    color: ${theme.buttonColor};\n  `;\n});\n","<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M17.8125 15.625H17.1875V3.125C17.1875 2.95924 17.1217 2.80027 17.0044 2.68306C16.8872 2.56585 16.7283 2.5 16.5625 2.5H12.1875C12.0217 2.5 11.8628 2.56585 11.7456 2.68306C11.6283 2.80027 11.5625 2.95924 11.5625 3.125V6.25H7.8125C7.64674 6.25 7.48777 6.31585 7.37056 6.43306C7.25335 6.55027 7.1875 6.70924 7.1875 6.875V10H3.4375C3.27174 10 3.11277 10.0658 2.99556 10.1831C2.87835 10.3003 2.8125 10.4592 2.8125 10.625V15.625H2.1875C2.02174 15.625 1.86277 15.6908 1.74556 15.8081C1.62835 15.9253 1.5625 16.0842 1.5625 16.25C1.5625 16.4158 1.62835 16.5747 1.74556 16.6919C1.86277 16.8092 2.02174 16.875 2.1875 16.875H17.8125C17.9783 16.875 18.1372 16.8092 18.2544 16.6919C18.3717 16.5747 18.4375 16.4158 18.4375 16.25C18.4375 16.0842 18.3717 15.9253 18.2544 15.8081C18.1372 15.6908 17.9783 15.625 17.8125 15.625ZM8.4375 7.5H11.5625V15.625H8.4375V7.5ZM4.0625 11.25H7.1875V15.625H4.0625V11.25Z\" fill=\"currentColor\"/>\n</svg>\n","<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M17.5 15.625H3.125V12.7812L7.53125 8.92969L12.125 12.375C12.24 12.4614 12.3813 12.5055 12.5251 12.4998C12.6688 12.4941 12.8062 12.439 12.9141 12.3438L17.9141 7.96875C17.9756 7.91437 18.0259 7.84841 18.0619 7.77461C18.098 7.70082 18.1192 7.62065 18.1242 7.53867C18.1293 7.45669 18.1182 7.37452 18.0915 7.29684C18.0648 7.21916 18.0231 7.14749 17.9688 7.08594C17.9144 7.02438 17.8484 6.97414 17.7746 6.93807C17.7008 6.90201 17.6206 6.88084 17.5387 6.87576C17.4567 6.87068 17.3745 6.8818 17.2968 6.90848C17.2192 6.93516 17.1475 6.97687 17.0859 7.03125L12.4688 11.0703L7.875 7.625C7.75997 7.5386 7.61866 7.49453 7.47491 7.50022C7.33116 7.50591 7.19377 7.56102 7.08594 7.65625L3.125 11.125V3.75C3.125 3.58424 3.05915 3.42527 2.94194 3.30806C2.82473 3.19085 2.66576 3.125 2.5 3.125C2.33424 3.125 2.17527 3.19085 2.05806 3.30806C1.94085 3.42527 1.875 3.58424 1.875 3.75V16.25C1.875 16.4158 1.94085 16.5747 2.05806 16.6919C2.17527 16.8092 2.33424 16.875 2.5 16.875H17.5C17.6658 16.875 17.8247 16.8092 17.9419 16.6919C18.0592 16.5747 18.125 16.4158 18.125 16.25C18.125 16.0842 18.0592 15.9253 17.9419 15.8081C17.8247 15.6908 17.6658 15.625 17.5 15.625Z\" fill=\"currentColor\"/>\n</svg>\n","<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M8.1251 15C7.95944 14.9977 7.80061 14.9336 7.67979 14.8203L3.30479 10.4453C3.20512 10.3239 3.15419 10.1697 3.1619 10.0128C3.1696 9.85587 3.2354 9.70744 3.34648 9.59636C3.45756 9.48527 3.606 9.41948 3.7629 9.41177C3.91981 9.40407 4.07398 9.455 4.19541 9.55466L8.1251 13.4922L16.4298 5.17966C16.5512 5.08 16.7054 5.02907 16.8623 5.03677C17.0192 5.04448 17.1676 5.11027 17.2787 5.22136C17.3898 5.33244 17.4556 5.48087 17.4633 5.63778C17.471 5.79469 17.4201 5.94885 17.3204 6.07029L8.57041 14.8203C8.44958 14.9336 8.29075 14.9977 8.1251 15Z\" fill=\"currentColor\"/>\n</svg>\n","<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M12.157 3.79383C12.0751 3.61284 11.8938 3.49752 11.6952 3.50004C11.4966 3.50256 11.3183 3.62243 11.2409 3.80543L8.43641 10.4442L7.29719 8.11376C7.21401 7.9436 7.04184 7.83505 6.85245 7.83336C6.66307 7.83167 6.48898 7.93713 6.40278 8.10577L1.97276 16.7724C1.89353 16.9274 1.90062 17.1125 1.99148 17.261C2.08234 17.4095 2.24389 17.5 2.41797 17.5H11.0846C11.0858 17.5 11.087 17.5 11.0882 17.5H17.5856C17.7555 17.5 17.9137 17.4138 18.0058 17.271C18.0979 17.1283 18.1112 16.9486 18.0411 16.7938L12.157 3.79383ZM11.3968 16.5H16.8105L11.7173 5.24746L9.01875 11.6354L11.3968 16.5ZM8.50275 12.8569L10.2837 16.5H6.96373L8.50275 12.8569ZM7.92042 11.6656L5.87815 16.5H3.23508L6.83801 9.45142L7.92042 11.6656Z\" fill=\"currentColor\"/>\n</svg>\n","<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M15.3536 4.64645C15.5488 4.84171 15.5488 5.15829 15.3536 5.35355L5.35355 15.3536C5.15829 15.5488 4.84171 15.5488 4.64645 15.3536C4.45118 15.1583 4.45118 14.8417 4.64645 14.6464L14.6464 4.64645C14.8417 4.45118 15.1583 4.45118 15.3536 4.64645ZM6.5 5.5C5.94772 5.5 5.5 5.94772 5.5 6.5C5.5 7.05228 5.94772 7.5 6.5 7.5C7.05228 7.5 7.5 7.05228 7.5 6.5C7.5 5.94772 7.05228 5.5 6.5 5.5ZM4.5 6.5C4.5 5.39543 5.39543 4.5 6.5 4.5C7.60457 4.5 8.5 5.39543 8.5 6.5C8.5 7.60457 7.60457 8.5 6.5 8.5C5.39543 8.5 4.5 7.60457 4.5 6.5ZM12.5 13.5C12.5 12.9477 12.9477 12.5 13.5 12.5C14.0523 12.5 14.5 12.9477 14.5 13.5C14.5 14.0523 14.0523 14.5 13.5 14.5C12.9477 14.5 12.5 14.0523 12.5 13.5ZM13.5 11.5C12.3954 11.5 11.5 12.3954 11.5 13.5C11.5 14.6046 12.3954 15.5 13.5 15.5C14.6046 15.5 15.5 14.6046 15.5 13.5C15.5 12.3954 14.6046 11.5 13.5 11.5Z\" fill=\"currentColor\"/>\n</svg>\n","<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M11.6875 3.125C11.6875 2.84886 11.9114 2.625 12.1875 2.625H16.5625C16.8386 2.625 17.0625 2.84886 17.0625 3.125V16.25C17.0625 16.5261 16.8386 16.75 16.5625 16.75H14.4464C14.4458 16.75 14.4451 16.75 14.4444 16.75H7.88346C7.86028 16.7533 7.83659 16.755 7.8125 16.755C7.78841 16.755 7.76472 16.7533 7.74154 16.75H3.4375C3.16136 16.75 2.9375 16.5261 2.9375 16.25V12.4372V11.4997V6.81216C2.9375 6.53602 3.16136 6.31216 3.4375 6.31216H7.3125V5.875C7.3125 5.59886 7.53636 5.375 7.8125 5.375H11.6875V3.125ZM7.3125 7.31216H3.9375V10.9997H7.3125V7.31216ZM7.3125 11.9997H3.9375V12.4372V15.75H7.3125V11.9997ZM8.3125 15.75V11.4997V6.81216V6.375H11.6875V15.75H8.3125ZM12.6875 15.75V5.875V3.625H16.0625V15.75H12.6875Z\" fill=\"currentColor\"/>\n</svg>\n","<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M10.1425 13L13.4871 7H6.79785L10.1425 13Z\" fill=\"currentColor\"/>\n</svg>\n","import ChartBarIcon from \"./icons/ChartBar.svg\";\nimport ChartLineIcon from \"./icons/ChartLine.svg\";\nimport CheckIcon from \"./icons/Check.svg\";\nimport CombinedIcon from \"./icons/Combined.svg\";\nimport PercentageIcon from \"./icons/Percentage.svg\";\nimport StackedIcon from \"./icons/Stacked.svg\";\nimport TriangleDownIcon from \"./icons/TriangleDown.svg\";\n\nexport const ICON_MAP = {\n  chart_bar: ChartBarIcon,\n  chart_line: ChartLineIcon,\n  check: CheckIcon,\n  combined: CombinedIcon,\n  percentage: PercentageIcon,\n  stacked: StackedIcon,\n  triangle_down: TriangleDownIcon,\n} as const;\n","import { ICON_MAP } from \"./IconMap\";\n\ntype IconType = keyof typeof ICON_MAP;\n\ntype Props = React.SVGProps<SVGSVGElement> & {\n  type: IconType;\n};\n\nexport function Icon({ type, ...svgProps }: Props): JSX.Element {\n  const Component = ICON_MAP[type];\n  return <Component {...svgProps} />;\n}\n","import { forwardRef, useContext } from \"react\";\nimport styled, { css } from \"styled-components\";\n\nimport { ChartThemeContext } from \"../theme\";\n\nexport const buttonStyling = css(() => {\n  const theme = useContext(ChartThemeContext);\n\n  return css`\n    --color: var(--button-normal-color);\n    --backgroundColor: var(--button-normal-backgroundColor);\n\n    outline: none;\n    cursor: pointer;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    transition-property: background-color, border-color;\n    transition-duration: 0.2s;\n    transition-timing-function: linear;\n    border-radius: ${theme.buttonBorderRadius};\n    box-sizing: border-box;\n    height: var(--icon-button-height, 20px);\n    width: var(--icon-button-width, 20px);\n    padding: var(--icon-button-padding, 2px);\n    color: var(--color);\n    background-color: var(--background);\n    border: 1px solid var(--background);\n\n    :focus,\n    :hover,\n    :active,\n    .active {\n      cursor: pointer;\n    }\n\n    :focus {\n      border-color: ${theme.buttonFocusBorderColor};\n      outline: ${theme.buttonFocusOutline};\n\n      --background: var(--button-focus-backgroundColor);\n      --color: var(--button-focus-color);\n    }\n\n    &:disabled {\n      cursor: default;\n\n      --color: var(--button-disabled-color);\n      --background: var(--button-disabled-backgroundColor);\n    }\n\n    &.active,\n    &:active:not([data-dragging], [disabled]) {\n      --background: var(--button-active-backgroundColor);\n      --color: var(--button-active-color);\n    }\n\n    :hover:not([data-disabled][data-dragging], [disabled]) {\n      --background: var(--button-hover-backgroundColor);\n      --color: var(--button-hover-color);\n      border: none;\n    }\n\n    & svg {\n      flex: 0 0 var(--icon-button-icon-size);\n      width: var(--icon-button-icon-size);\n      height: var(--icon-button-icon-size);\n    }\n  `;\n});\n\nconst StyledButton = styled.button`\n  ${buttonStyling}\n`;\n\nconst buttonSize = {\n  padding: \"6px\",\n  width: \"32px\",\n  height: \"32px\",\n  iconSize: \"20px\",\n};\n\nexport type Props = React.ButtonHTMLAttributes<HTMLButtonElement> & {\n  active?: boolean;\n};\n\nexport const IconButton = forwardRef(function IconButton(\n  props: Props,\n  ref: React.ForwardedRef<HTMLButtonElement>,\n): JSX.Element {\n  const {\n    className = \"\",\n    style = {},\n    active = false,\n    children,\n    ...otherProps\n  } = props;\n\n  const theme = useContext(ChartThemeContext);\n\n  const newStyle = {\n    ...style,\n    \"--icon-button-padding\": buttonSize.padding,\n    \"--icon-button-width\": buttonSize.width,\n    \"--icon-button-height\": buttonSize.height,\n    \"--icon-button-icon-size\": buttonSize.iconSize,\n\n    \"--button-normal-color\": theme.buttonColor,\n    \"--button-normal-backgroundColor\": theme.buttonBackgroundColor,\n    \"--button-hover-color\": theme.buttonHoverColor,\n    \"--button-hover-backgroundColor\": theme.buttonHoverBackgroundColor,\n    \"--button-active-color\": theme.buttonActiveColor,\n    \"--button-active-backgroundColor\": theme.buttonActiveBackgroundColor,\n    \"--button-focus-color\": theme.buttonFocusColor,\n    \"--button-focus-backgroundColor\": theme.buttonFocusBackgroundColor,\n    \"--button-disabled-color\": theme.buttonDisabledColor,\n    \"--button-disabled-backgroundColor\": theme.buttonDisabledBackgroundColor,\n  };\n\n  const elementProps = {\n    ...otherProps,\n    ref,\n    style: newStyle,\n    className: active ? `${className} active` : className,\n    \"aria-pressed\": active,\n  };\n\n  return <StyledButton {...elementProps}>{children}</StyledButton>;\n});\n","/**\n * Strips all falsy values from an array.\n */\nexport function compact<T>(\n  items: Array<T | false | undefined | null | 0 | \"\">,\n): Array<T> {\n  return items.filter(Boolean) as Array<T>;\n}\n","import type { Timeseries } from \"../providerTypes\";\n\n/**\n * Return a list of keys whose values vary across series (or don't exist\n * everywhere).\n */\nexport function findUniqueKeys(timeseriesData: Array<Timeseries>) {\n  let constantKeys: Set<string> | undefined;\n  let detectedValues: Record<string, string> = {};\n\n  for (const timeseries of timeseriesData) {\n    const keys = Object.keys(timeseries.labels);\n\n    if (constantKeys === undefined) {\n      constantKeys = new Set(keys);\n      detectedValues = { ...timeseries.labels };\n    } else {\n      for (const key of keys) {\n        if (detectedValues[key] !== timeseries.labels[key]) {\n          constantKeys.delete(key);\n        }\n\n        detectedValues[key] = timeseries.labels[key] || \"\";\n      }\n    }\n  }\n\n  const allKeys = Object.keys(detectedValues);\n  return allKeys.filter(\n    (key) => constantKeys === undefined || constantKeys.has(key) === false,\n  );\n}\n","/**\n * Returns the input value.\n *\n * A function that only returns its input is also known as the identity\n * function.\n */\nexport function identity<T>(input: T): T {\n  return input;\n}\n","/**\n * Taken from: https://github.com/gregberge/react-merge-refs\n *\n * Copyright (c) 2020 Greg Bergé\n *\n * @license MIT\n */\nexport function mergeRefs<T extends HTMLElement>(\n  refs: Array<React.MutableRefObject<T> | React.LegacyRef<T>>,\n): React.RefCallback<T> {\n  return (value) => {\n    for (const ref of refs) {\n      if (typeof ref === \"function\") {\n        ref(value);\n      } else if (ref != null) {\n        (ref as React.MutableRefObject<T | null>).current = value;\n      }\n    }\n  };\n}\n","export function noop() {}\n","export function preventDefault(event: Event | React.SyntheticEvent) {\n  event.preventDefault();\n}\n","/**\n * Sorts an array ascending by priority.\n *\n * *Warning:* As this function uses `Array#sort()` it also mutates the input\n * array.\n */\nexport function sortBy<T, U extends number | string>(\n  array: Array<T>,\n  getPriorityFn: (item: T) => U,\n  reverse = false,\n) {\n  return array.sort((a, b) => {\n    const priorityA = getPriorityFn(a);\n    const priorityB = getPriorityFn(b);\n    if (priorityA < priorityB) {\n      return reverse === true ? 1 : -1;\n    } else if (priorityA > priorityB) {\n      return reverse === true ? -1 : 1;\n    } else {\n      return 0;\n    }\n  });\n}\n","import type { Timestamp } from \"../providerTypes\";\n\nexport const secondsToTimestamp = (seconds: number): Timestamp =>\n  new Date(seconds * 1000).toISOString();\n\nexport const timestampToSeconds = (timestamp: Timestamp): number =>\n  new Date(timestamp).getTime() / 1000;\n","const os =\n  typeof navigator === \"undefined\"\n    ? \"\"\n    : navigator.platform.match(/mac|win|linux/i)?.[0]?.toLowerCase();\n\nexport const isMac = os === \"mac\";\n","import {\n  ButtonGroup,\n  ControlsContainer,\n  ControlsGroup,\n  ControlsSet,\n  ControlsSetLabel,\n  Icon,\n  IconButton,\n} from \"../BaseComponents\";\nimport type { GraphType, StackingType } from \"../providerTypes\";\nimport { preventDefault } from \"../utils\";\n\nexport type ChartControlsProps = {\n  children?: JSX.Element;\n  graphType: GraphType;\n  onChangeGraphType?: (graphType: GraphType) => void;\n  onChangeStackingType?: (stackingType: StackingType) => void;\n  stackingControlsShown: boolean;\n  stackingType: StackingType;\n};\n\n/**\n * Control what kind fo chart you're viewing (and more)\n */\nexport function ChartControls({\n  children,\n  graphType,\n  onChangeGraphType,\n  onChangeStackingType,\n  stackingControlsShown,\n  stackingType,\n}: ChartControlsProps): JSX.Element | null {\n  if (!onChangeGraphType && !onChangeStackingType) {\n    return null;\n  }\n\n  return (\n    <ControlsContainer>\n      <ControlsGroup key=\"built_in\">\n        {onChangeGraphType && (\n          <ControlsSet>\n            <ControlsSetLabel>Type</ControlsSetLabel>\n            <ButtonGroup>\n              <IconButton\n                active={graphType === \"line\"}\n                aria-label=\"Line chart\"\n                className=\"iconButton\"\n                onClick={(event) => {\n                  preventDefault(event);\n                  onChangeGraphType(\"line\");\n                }}\n              >\n                <Icon type=\"chart_line\" />\n              </IconButton>\n\n              <IconButton\n                active={graphType === \"bar\"}\n                aria-label=\"Bar chart\"\n                className=\"iconButton\"\n                onClick={(event) => {\n                  preventDefault(event);\n                  onChangeGraphType(\"bar\");\n                }}\n              >\n                <Icon type=\"chart_bar\" />\n              </IconButton>\n            </ButtonGroup>\n          </ControlsSet>\n        )}\n\n        {stackingControlsShown && onChangeStackingType && (\n          <ControlsSet>\n            <ControlsSetLabel>Stacking</ControlsSetLabel>\n            <ButtonGroup>\n              <IconButton\n                active={stackingType === \"none\"}\n                aria-label=\"Combined/default\"\n                className=\"iconButton\"\n                onClick={(event) => {\n                  preventDefault(event);\n                  onChangeStackingType(\"none\");\n                }}\n              >\n                <Icon type=\"combined\" />\n              </IconButton>\n\n              <IconButton\n                active={stackingType === \"stacked\"}\n                aria-label=\"Stacked\"\n                className=\"iconButton\"\n                type=\"button\"\n                onClick={(event) => {\n                  preventDefault(event);\n                  onChangeStackingType(\"stacked\");\n                }}\n              >\n                <Icon type=\"stacked\" />\n              </IconButton>\n\n              <IconButton\n                active={stackingType === \"percentage\"}\n                aria-label=\"Stacked/percentage\"\n                className=\"iconButton\"\n                onClick={(event) => {\n                  preventDefault(event);\n                  onChangeStackingType(\"percentage\");\n                }}\n              >\n                <Icon type=\"percentage\" />\n              </IconButton>\n            </ButtonGroup>\n          </ControlsSet>\n        )}\n      </ControlsGroup>\n      {children && <ControlsGroup key=\"custom\">{children}</ControlsGroup>}\n    </ControlsContainer>\n  );\n}\n","import { createContext } from \"react\";\n\nexport type ChartSizeContextValue = {\n  width: number;\n  height: number;\n  xMax: number;\n  yMax: number;\n  marginTop: number;\n  marginRight: number;\n  marginBottom: number;\n  marginLeft: number;\n};\n\n/**\n * Context for tracking the size of the chart.\n */\nexport const ChartSizeContext = createContext<ChartSizeContextValue>({\n  width: 0,\n  height: 0,\n  xMax: 0,\n  yMax: 0,\n  marginTop: 0,\n  marginRight: 0,\n  marginBottom: 0,\n  marginLeft: 0,\n});\n","import { useCallback, useRef } from \"react\";\n\nconst noDeps: Array<void> = [];\n\nexport function useHandler<Handler extends Function>(\n  handler: Handler,\n): Handler {\n  const handlerRef = useRef(handler);\n  handlerRef.current = handler;\n\n  // @ts-ignore\n  // rome-ignore lint/nursery/useHookAtTopLevel: https://github.com/rome/tools/issues/4483\n  return useCallback((...args) => handlerRef.current(...args), noDeps);\n}\n","import styled, { css } from \"styled-components\";\nimport { useRef, useState, useEffect, useContext } from \"react\";\n\nimport { Icon } from \"../BaseComponents\";\nimport { useHandler } from \"./useHandler\";\nimport { ChartThemeContext } from \"../theme\";\n\ntype Options = {\n  /**\n   * Default height (assumed to be in pixels).\n   */\n  defaultHeight: number;\n};\n\ntype Result<T> = {\n  /**\n   * Component you should include in your output to allow the user to toggle\n   * the expanded state, if relevant.\n   */\n  expandButton?: JSX.Element;\n\n  /**\n   * Component you may need to include in your output to display the gradient\n   * to indicate the collapsed state, if relevant.\n   */\n  gradient?: JSX.Element;\n\n  /**\n   * Whether the expandable container is currently expanded.\n   */\n  isExpanded: boolean;\n\n  /**\n   * Scroll event listener to attach to the container.\n   */\n  onScroll: () => void;\n\n  /**\n   * Ref to attach to the container.\n   */\n  ref: React.RefCallback<T>;\n};\n\n/**\n * Implements all the logic needed to create an expandable container.\n */\nexport function useExpandable<T extends HTMLElement = HTMLDivElement>({\n  defaultHeight,\n}: Options): Result<T> {\n  const ref = useRef<T | null>(null);\n\n  const [showExpandButton, setShowExpandButton] = useState(false);\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [showGradient, setShowGradient] = useState(false);\n\n  const update = useHandler((element: Element) => {\n    const { scrollTop, scrollHeight, clientHeight } = element;\n\n    if (scrollHeight <= defaultHeight) {\n      setShowExpandButton(false);\n      setShowGradient(false);\n    } else {\n      setShowExpandButton(true);\n      setShowGradient(scrollHeight - scrollTop > clientHeight);\n    }\n  });\n\n  // This calls update function with a tiny delay. This fixes\n  // errors with the ResizeObserver loop taking too long\n  const asyncUpdate = useHandler(() => {\n    setTimeout(() => {\n      if (ref.current) {\n        update(ref.current);\n      }\n    }, 0);\n  });\n\n  useEffect(() => {\n    return () => {\n      if (ref.current) {\n        unsubscribeFromNode(ref.current, asyncUpdate);\n        ref.current = null;\n      }\n    };\n  }, [asyncUpdate]);\n\n  const setRef = useHandler((node: T | null) => {\n    if (ref.current === node) {\n      return;\n    }\n\n    if (ref.current) {\n      unsubscribeFromNode(ref.current, asyncUpdate);\n    }\n\n    if (node) {\n      subscribeToNode(node, asyncUpdate);\n      update(node);\n    }\n\n    ref.current = node;\n  });\n\n  const onClickExpand = useHandler(() => {\n    setIsExpanded(!isExpanded);\n  });\n\n  return {\n    expandButton: showExpandButton ? (\n      <Expand onClick={onClickExpand} revert={isExpanded}>\n        <Icon type=\"triangle_down\" />\n      </Expand>\n    ) : undefined,\n    gradient: showGradient ? (\n      <GradientContainer>\n        <Gradient />\n      </GradientContainer>\n    ) : undefined,\n    isExpanded: isExpanded || !showExpandButton,\n    onScroll: asyncUpdate,\n    ref: setRef,\n  };\n}\n\ntype Listener = () => void;\n\nconst listenerMap: WeakMap<Element, Set<Listener>> = new WeakMap();\n\nlet observer: ResizeObserver | undefined;\n\nfunction observerCallback(entries: ResizeObserverEntry[]) {\n  for (const entry of entries) {\n    const listeners = listenerMap.get(entry.target);\n    if (listeners) {\n      for (const listener of listeners) {\n        listener();\n      }\n    }\n  }\n}\n\nfunction subscribeToNode(node: Element, listener: Listener) {\n  const listeners = listenerMap.get(node);\n  if (listeners) {\n    listeners.add(listener);\n  } else {\n    listenerMap.set(node, new Set([listener]));\n\n    if (!observer) {\n      observer = new ResizeObserver(observerCallback);\n    }\n\n    observer.observe(node);\n  }\n}\n\nfunction unsubscribeFromNode(node: Element, listener: Listener) {\n  const listeners = listenerMap.get(node);\n\n  if (listeners) {\n    listeners.delete(listener);\n\n    if (listeners.size === 0) {\n      listenerMap.delete(node);\n\n      observer?.unobserve(node);\n    }\n  }\n}\n\nconst Expand = styled.div<{ revert: boolean }>`\n  color: #4797ff;\n  width: 24px;\n  height: 24px;\n  border-radius: 6px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  transform: ${({ revert }) => (revert ? \"rotate(180deg)\" : \"none\")};\n\n  &:hover {\n    cursor: pointer;\n    background: rgba(71, 151, 255, 30%);\n  }\n`;\n\nconst Gradient = styled.div(() => {\n  const theme = useContext(ChartThemeContext);\n\n  return css`\n    width: 100%;\n    position: absolute;\n    bottom: 0;\n    height: 39px;\n    background-image: linear-gradient(\n      to bottom,\n      transparent,\n      ${theme.expandableGradientColor} 50%\n    );\n\n    border-bottom-right-radius: 6px;\n    pointer-events: none;\n  `;\n});\n\n// The container is sticky, but zero height to prevent the gradient itself\n// from reserving any space.\nconst GradientContainer = styled.div`\n  bottom: 0;\n  height: 0;\n  position: sticky;\n  width: 100%;\n`;\n","import { useReducer } from \"react\";\n\nconst reducer = (counter: number): number => counter + 1;\n\nexport function useForceUpdate(): () => void {\n  const [, forceUpdate] = useReducer(reducer, 0);\n\n  return forceUpdate;\n}\n","import { useEffect, useState } from \"react\";\n\nconst noEntries: Array<IntersectionObserverEntry> = [];\n\nexport function useIntersectionObserver(\n  ref: React.RefObject<HTMLElement>,\n  options?: IntersectionObserverInit,\n) {\n  const [intersections, setIntersections] = useState(noEntries);\n\n  const element = ref.current;\n  useEffect(() => {\n    if (!element) {\n      return;\n    }\n\n    const observer = new IntersectionObserver(setIntersections, options);\n    observer.observe(element);\n    return () => {\n      observer.disconnect();\n      setIntersections(noEntries);\n    };\n  }, [element, options]);\n\n  return intersections;\n}\n","import { useLayoutEffect, useMemo, useState } from \"react\";\n\ntype Dimensions = { width: number; height: number };\n\nconst defaultDimensions: Dimensions = {\n  width: 0,\n  height: 0,\n};\n\nexport function useMeasure<T extends HTMLElement>(): [\n  React.RefCallback<T>,\n  Dimensions,\n] {\n  const [element, setElement] = useState<T | null>(null);\n  const [rect, setRect] = useState(defaultDimensions);\n\n  const observer = useMemo(\n    () =>\n      new window.ResizeObserver((entries) => {\n        const entry = entries[0];\n        if (entry) {\n          const { width, height } = entry.contentRect;\n          setRect({ width, height });\n        }\n      }),\n    [],\n  );\n\n  useLayoutEffect(() => {\n    if (!element) {\n      return;\n    }\n\n    observer.observe(element);\n    return () => {\n      observer.disconnect();\n    };\n  }, [element, observer]);\n\n  return [setElement, rect];\n}\n","import { debounce } from \"throttle-debounce\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\n\nimport { ChartSizeContext, ChartSizeContextValue } from \"./ChartSizeContext\";\nimport { mergeRefs } from \"../utils\";\nimport { useIntersectionObserver, useMeasure } from \"../hooks\";\n\ntype Props = {\n  children: React.ReactNode;\n  className?: string;\n  // By default the measured height will be used unless this value is specified\n  // This is useful for charts that contain more than just the chart (but also a legend, for example)\n  overrideHeight?: number;\n  marginTop?: number;\n  marginLeft?: number;\n  marginRight?: number;\n  marginBottom?: number;\n};\n\nexport function ChartSizeContainerProvider({\n  children,\n  className,\n  overrideHeight,\n  marginTop = 0,\n  marginRight = 0,\n  marginBottom = 0,\n  marginLeft = 0,\n}: Props) {\n  const [measureRef, { width, height: measuredHeight }] =\n    useMeasure<HTMLDivElement>();\n  const intersectionRef = useRef<HTMLDivElement>(null);\n  const ref = mergeRefs([measureRef, intersectionRef]);\n\n  const intersections = useIntersectionObserver(\n    intersectionRef,\n    intersectionOptions,\n  );\n  const [value, setValue] = useState<ChartSizeContextValue>({\n    xMax: 0,\n    yMax: 0,\n    width: 0,\n    height: 0,\n    marginTop,\n    marginRight,\n    marginBottom,\n    marginLeft,\n  });\n\n  const height = overrideHeight ?? measuredHeight;\n  const updateValue = useMemo(\n    () =>\n      debounce(100, (width: number, height: number) =>\n        setValue({\n          xMax: width - marginLeft - marginRight,\n          yMax: height - marginTop - marginBottom,\n          width,\n          height,\n          marginTop,\n          marginRight,\n          marginBottom,\n          marginLeft,\n        }),\n      ),\n    [marginTop, marginRight, marginBottom, marginLeft],\n  );\n\n  useEffect(() => {\n    updateValue(width, height);\n  }, [width, height, updateValue]);\n\n  return (\n    <div ref={ref} className={className}>\n      {value.width > 0 &&\n      value.height > 0 &&\n      intersections.some((intersection) => intersection.isIntersecting) ? (\n        <ChartSizeContext.Provider value={value}>\n          {children}\n        </ChartSizeContext.Provider>\n      ) : (\n        <ChartSkeleton height={height} />\n      )}\n    </div>\n  );\n}\n\nfunction ChartSkeleton({ height }: { height: number }) {\n  return <div style={{ height }} />;\n}\n\nconst intersectionOptions = {\n  root: null,\n  rootMargin: \"0px\",\n  threshold: 0,\n};\n","import type { CoordinateFactory } from \"./types\";\n\nexport function toFactory<P>(\n  coordinate: number | CoordinateFactory<P>,\n): CoordinateFactory<P> {\n  return typeof coordinate === \"function\"\n    ? coordinate\n    : constantFactory(coordinate);\n}\n\nfunction constantFactory(value: number): () => number {\n  return () => value;\n}\n","import type { CoordinateFactory } from \"./types\";\nimport { toFactory } from \"./utils\";\n\n/**\n * Set of factories for producing X and Y coordinates for an area shape.\n *\n * The restriction for an area path is that every data point must produce two\n * coordinates for the Y axis, and one coordinate for the X axis.\n */\nexport type AreaPathCoordinateFactories<P> = {\n  x: number | CoordinateFactory<P>;\n  y0: number | CoordinateFactory<P>;\n  y1: number | CoordinateFactory<P>;\n};\n\n/**\n * Creates the SVG path definition for an area shape.\n *\n * @param data The data points for the area.\n * @param coordinates The factories and/or constants to produce the coordinates\n *                    from each data point.\n *\n * See also: https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d\n */\nexport function createAreaPathDef<P>(\n  data: Array<P>,\n  coordinates: AreaPathCoordinateFactories<P>,\n): string {\n  const len = data.length;\n  if (len === 0) {\n    return \"\";\n  }\n\n  const x = toFactory(coordinates.x);\n  const y0 = toFactory(coordinates.y0);\n  const y1 = toFactory(coordinates.y1);\n\n  const start = data[0];\n  let path = `M${x(start).toFixed(1)},${y0(start).toFixed(1)}`;\n\n  // Draw a line along the y0 coordinates.\n  for (let i = 1; i < len; ++i) {\n    const next = data[i];\n    path += `L${x(next).toFixed(1)},${y0(next).toFixed(1)}`;\n  }\n\n  // Draw a line backwards along the y1 coordinates.\n  for (let i = len - 1; i >= 0; --i) {\n    const previous = data[i];\n    path += `L${x(previous).toFixed(1)},${y1(previous).toFixed(1)}`;\n  }\n\n  // Done.\n  path += \"Z\";\n  return path;\n}\n","import type { CoordinateFactory } from \"./types\";\nimport { toFactory } from \"./utils\";\n\n/**\n * Set of factories for producing X and Y coordinates for a line path.\n */\nexport type LinePathCoordinateFactories<P> = {\n  x: number | CoordinateFactory<P>;\n  y: number | CoordinateFactory<P>;\n};\n\n/**\n * Creates the SVG path definition for a line shape.\n *\n * @param data The data points for the line.\n * @param coordinates The factories and/or constants to produce the coordinates\n *                    from each data point.\n *\n * See also: https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d\n */\nexport function createLinePathDef<P>(\n  data: Array<P>,\n  coordinates: LinePathCoordinateFactories<P>,\n): string {\n  const len = data.length;\n  if (len === 0) {\n    return \"\";\n  }\n\n  const x = toFactory(coordinates.x);\n  const y = toFactory(coordinates.y);\n\n  const start = data[0];\n  let path = `M${x(start).toFixed(1)},${y(start).toFixed(1)}`;\n\n  // Draw a line along the data points.\n  for (let i = 1; i < len; ++i) {\n    const next = data[i];\n    path += `L${x(next).toFixed(1)},${y(next).toFixed(1)}`;\n  }\n\n  return path;\n}\n","import { memo, useId } from \"react\";\n\nimport type { Area } from \"../../Mondrian\";\nimport type { CommonShapeProps } from \"./types\";\nimport { createAreaPathDef } from \"./paths\";\n\ntype Props<P> = CommonShapeProps & {\n  area: Area<P>;\n};\n\nexport const AreaShape = memo(function AreaShape<P>({\n  anyFocused,\n  areaGradientShown,\n  area,\n  color,\n  focused,\n  scales,\n}: Props<P>): JSX.Element {\n  const id = useId();\n  const gradientId = `line-${id}`;\n  const gradientRef = `url(#${gradientId})`;\n\n  const x = (point: { x: number }) => scales.xScale(point.x);\n  const y0 = (point: { yMin: number }) => scales.yScale(point.yMin);\n  const y1 = (point: { yMax: number }) => scales.yScale(point.yMax);\n\n  return (\n    <g opacity={focused || !anyFocused ? 1 : 0.2}>\n      {areaGradientShown && (\n        <defs>\n          <linearGradient id={gradientId} x1={0} y1={0} x2={0} y2={1}>\n            <stop offset=\"0%\" stopColor={color} stopOpacity={0.3} />\n            <stop offset=\"80%\" stopColor={color} stopOpacity={0.06} />\n          </linearGradient>\n        </defs>\n      )}\n      <path\n        d={createAreaPathDef(area.points, { x, y0, y1 })}\n        stroke={color}\n        strokeDasharray={area.strokeDasharray?.join(\" \")}\n        strokeWidth={focused ? 1.5 : 1}\n        fill={areaGradientShown ? gradientRef : \"none\"}\n      />\n    </g>\n  );\n});\n","import { memo, useId } from \"react\";\n\nimport type { CommonShapeProps } from \"./types\";\nimport type { Line } from \"../../Mondrian\";\nimport { createAreaPathDef, createLinePathDef } from \"./paths\";\n\ntype Props<P> = CommonShapeProps & {\n  line: Line<P>;\n};\n\nexport const LineShape = memo(function LineShape<P>({\n  anyFocused,\n  areaGradientShown,\n  color,\n  focused,\n  line,\n  scales,\n}: Props<P>): JSX.Element {\n  const id = useId();\n  const gradientId = `line-${id}`;\n\n  const x = (point: { x: number }) => scales.xScale(point.x);\n  const y = (point: { y: number }) => scales.yScale(point.y);\n\n  return (\n    <g opacity={focused || !anyFocused ? 1 : 0.2}>\n      {areaGradientShown && (\n        <defs>\n          <linearGradient id={gradientId} x1={0} y1={0} x2={0} y2={1}>\n            <stop offset=\"0%\" stopColor={color} stopOpacity={0.15} />\n            <stop offset=\"23%\" stopColor={color} stopOpacity={0.03} />\n          </linearGradient>\n        </defs>\n      )}\n      {areaGradientShown && (\n        <path\n          d={createAreaPathDef(line.points, { x, y0: y, y1: scales.yScale(0) })}\n          stroke=\"none\"\n          fill={`url(#${gradientId})`}\n        />\n      )}\n      <path\n        d={createLinePathDef(line.points, { x, y })}\n        stroke={color}\n        strokeDasharray={line.strokeDasharray?.join(\" \")}\n        strokeWidth={focused ? 1.5 : 1}\n        fill=\"none\"\n      />\n    </g>\n  );\n});\n","// Dimensions of the chart\nexport const HEIGHT = 275;\nexport const MARGINS = { top: 0, bottom: 20, left: 38, right: 0 };\n\n// Dimensions of points on the chart\nexport const POINT_RADIUS = 1;\nexport const POINT_RADIUS_FOCUSED = 2;\n\n// If a point is directly on the edge of the chart, it can be cut off.\n// This overflow margin ensures that the point is still visible.\nexport const CHART_SHAPE_OVERFLOW_MARGIN = POINT_RADIUS_FOCUSED;\n","import { memo } from \"react\";\n\nimport type { CommonShapeProps } from \"./types\";\nimport type { Point } from \"../../Mondrian\";\nimport { POINT_RADIUS, POINT_RADIUS_FOCUSED } from \"../constants\";\n\ntype Props<P> = CommonShapeProps & {\n  point: Point<P>;\n};\n\nexport const PointShape = memo(function PointShape<P>({\n  color,\n  focused,\n  point,\n  scales,\n}: Props<P>): JSX.Element {\n  return (\n    <circle\n      cx={scales.xScale(point.x)}\n      cy={scales.yScale(point.y)}\n      r={focused ? POINT_RADIUS_FOCUSED : POINT_RADIUS}\n      stroke={color}\n      fill={color}\n    />\n  );\n});\n","import { memo } from \"react\";\n\nimport type { CommonShapeProps } from \"./types\";\nimport type { Rectangle } from \"../../Mondrian\";\n\ntype Props<P> = CommonShapeProps & {\n  rectangle: Rectangle<P>;\n};\n\nexport const RectangleShape = memo(function RectangleShape<P>({\n  anyFocused,\n  color,\n  focused,\n  rectangle,\n  scales: { xMax, yMax },\n}: Props<P>): JSX.Element {\n  const height = rectangle.height * yMax;\n\n  return (\n    <rect\n      x={rectangle.x * xMax}\n      y={yMax - rectangle.y * yMax - height}\n      width={rectangle.width * xMax}\n      height={height}\n      stroke={color}\n      fill={color}\n      fillOpacity={0.1}\n      opacity={focused || !anyFocused ? 1 : 0.2}\n    />\n  );\n});\n","import { AreaShape } from \"./AreaShape\";\nimport type { CommonShapeProps } from \"./types\";\nimport { LineShape } from \"./LineShape\";\nimport { PointShape } from \"./PointShape\";\nimport { RectangleShape } from \"./RectangleShape\";\nimport type { Shape } from \"../../Mondrian\";\n\ntype Props<P> = CommonShapeProps & { shape: Shape<P> };\n\nexport function ChartShape<P>({ shape, ...props }: Props<P>): JSX.Element {\n  switch (shape.type) {\n    case \"area\":\n      return <AreaShape area={shape} {...props} />;\n\n    case \"line\":\n      return <LineShape line={shape} {...props} />;\n\n    case \"point\":\n      return <PointShape point={shape} {...props} />;\n\n    case \"rectangle\":\n      return <RectangleShape rectangle={shape} {...props} />;\n  }\n}\n","import type { AbstractChart, ShapeList } from \"../Mondrian\";\nimport { ChartShape } from \"./ChartShape\";\nimport type { Scales } from \"./types\";\n\ntype Props<S, P> = {\n  areaGradientShown: boolean;\n  chart: AbstractChart<S, P>;\n  focusedShapeList: ShapeList<S, P> | null;\n  getShapeListColor: (source: S, index: number) => string;\n  scales: Scales;\n};\n\nexport function ChartContent<S, P>({\n  areaGradientShown,\n  chart,\n  focusedShapeList,\n  getShapeListColor,\n  scales,\n}: Props<S, P>): JSX.Element {\n  return (\n    <>\n      {chart.shapeLists.flatMap((shapeList, listIndex) =>\n        shapeList.shapes.map((shape, shapeIndex) => (\n          <ChartShape\n            anyFocused={!!focusedShapeList}\n            areaGradientShown={areaGradientShown}\n            color={getShapeListColor(shapeList.source, listIndex)}\n            focused={shapeList === focusedShapeList}\n            key={`${listIndex}-${shapeIndex}`}\n            scales={scales}\n            shape={shape}\n          />\n        )),\n      )}\n    </>\n  );\n}\n","import type { Axis } from \"../../Mondrian\";\nimport type { Scales, TickFormatters } from \"../types\";\nimport { ChartThemeContext } from \"../../theme\";\nimport { useContext } from \"react\";\n\nconst LABEL_OFFSET = 8;\n\ntype Props = {\n  formatter: TickFormatters[\"xFormatter\"];\n  scales: Scales;\n  strokeColor: string;\n  strokeDasharray?: string;\n  ticks: Array<number>;\n  xAxis: Axis;\n};\n\nexport function BottomAxis({\n  formatter,\n  scales: { xMax, xScale, yMax },\n  strokeColor,\n  strokeDasharray,\n  ticks,\n  xAxis: { maxValue, minValue },\n}: Props) {\n  const {\n    axisColor,\n    axisFontSize,\n    axisFontFamily,\n    axisFontStyle,\n    axisFontWeight,\n    axisLetterSpacing,\n  } = useContext(ChartThemeContext);\n\n  return (\n    <g transform={`translate(0, ${yMax})`}>\n      <line\n        x1={0}\n        y1={0}\n        x2={xMax}\n        y2={0}\n        stroke={strokeColor}\n        strokeDasharray={strokeDasharray}\n      />\n\n      {ticks.map((time, index) => (\n        <text\n          // rome-ignore lint/suspicious/noArrayIndexKey: no better key available\n          key={index}\n          x={xScale((time - minValue) / (maxValue - minValue))}\n          y={axisFontSize}\n          dy={LABEL_OFFSET}\n          fill={axisColor}\n          fontFamily={axisFontFamily}\n          fontStyle={axisFontStyle}\n          fontWeight={axisFontWeight}\n          fontSize={axisFontSize}\n          letterSpacing={axisLetterSpacing}\n          textAnchor=\"middle\"\n        >\n          {formatter(time)}\n        </text>\n      ))}\n    </g>\n  );\n}\n","import type { ChartCoordinates, Dimensions, Scale } from \"./types\";\nimport { MARGINS } from \"./constants\";\n\nexport type Range = [from: number, to: number];\n\n/**\n * Creates a linear scale function for the given range.\n *\n * Assumes a domain of `[0.0..1.0]` as used for our abstract chart coordinates.\n */\nexport function createLinearScaleForRange([from, to]: Range): Scale {\n  return (value) => from + value * (to - from);\n}\n\nexport function getCoordinatesForEvent(\n  event: React.MouseEvent<SVGElement> | WheelEvent,\n  { xMax, yMax }: Dimensions,\n): ChartCoordinates | null {\n  const svg = getTarget(event);\n  if (!svg) {\n    return null;\n  }\n\n  const rect = svg.getBoundingClientRect();\n\n  const x = event.clientX - rect.left - MARGINS.left;\n  const y = event.clientY - rect.top - MARGINS.top;\n  if (x < 0 || x > xMax || y < 0 || y > yMax) {\n    return null;\n  }\n\n  return { x: x / xMax, y: 1 - y / yMax };\n}\n\n/**\n * Finds the root `<svg>` element we use as target. Most event listeners are\n * directly attached to it, but some may be attached elsewhere and we need to\n * travel from the `event.target` to find it.\n */\nfunction getTarget(\n  event: React.MouseEvent<SVGElement> | WheelEvent,\n): SVGSVGElement | null {\n  if (event.currentTarget instanceof SVGSVGElement) {\n    return event.currentTarget;\n  }\n\n  let target = event.target as HTMLElement | SVGElement | null;\n  while (target) {\n    if (target instanceof SVGSVGElement) {\n      return target;\n    }\n\n    target = target.parentElement;\n  }\n\n  return null;\n}\n","import type { Axis } from \"../../Mondrian\";\nimport type { Scales } from \"../types\";\n\ntype Props = {\n  scales: Scales;\n  stroke: string;\n  strokeDasharray?: string;\n  xAxis: Axis;\n  xTicks: Array<number>;\n};\n\nexport function GridColumns({\n  scales: { xScale, yMax },\n  xAxis: { maxValue, minValue },\n  xTicks,\n  ...lineProps\n}: Props): JSX.Element {\n  return (\n    <g>\n      {xTicks.map((time, index) => {\n        const x = xScale((time - minValue) / (maxValue - minValue));\n        return (\n          <line\n            // rome-ignore lint/suspicious/noArrayIndexKey: no better key available\n            key={index}\n            x1={x}\n            y1={0}\n            x2={x}\n            y2={yMax}\n            {...lineProps}\n          />\n        );\n      })}\n    </g>\n  );\n}\n","import type { Scale } from \"../types\";\n\ntype Props = {\n  stroke: string;\n  strokeDasharray?: string;\n  xMax: number;\n  yScale: Scale;\n  yTicks: Array<number>;\n};\n\nexport function GridRows({\n  xMax,\n  yScale,\n  yTicks,\n  ...lineProps\n}: Props): JSX.Element {\n  return (\n    <g>\n      {yTicks.map((value, index) => {\n        const y = yScale(value);\n        return (\n          <line\n            // rome-ignore lint/suspicious/noArrayIndexKey: no better key available\n            key={index}\n            x1={0}\n            y1={y}\n            x2={xMax}\n            y2={y}\n            {...lineProps}\n          />\n        );\n      })}\n    </g>\n  );\n}\n","import type { Scales, TickFormatters } from \"../types\";\nimport { useContext } from \"react\";\nimport { ChartThemeContext } from \"../../theme\";\n\ntype Props = {\n  formatter: TickFormatters[\"yFormatter\"];\n  gridBordersShown: boolean;\n  scales: Scales;\n  strokeColor: string;\n  strokeDasharray?: string;\n  ticks: Array<number>;\n};\n\nexport function LeftAxis({\n  formatter,\n  gridBordersShown,\n  scales: { yMax, yScale },\n  strokeColor,\n  strokeDasharray,\n  ticks,\n}: Props) {\n  const {\n    axisColor,\n    axisFontSize,\n    axisFontFamily,\n    axisFontStyle,\n    axisFontWeight,\n    axisLetterSpacing,\n  } = useContext(ChartThemeContext);\n\n  const tickLabelProps = {\n    dx: \"-0.45em\",\n    dy: \"0.25em\",\n    textAnchor: \"end\" as const,\n    fontFamily: axisFontFamily,\n    fontStyle: axisFontStyle,\n    fontWeight: axisFontWeight,\n    fontSize: axisFontSize,\n    letterSpacing: axisLetterSpacing,\n    fill: axisColor,\n  };\n\n  const numTicks = ticks.length - 1;\n\n  return (\n    <g>\n      {gridBordersShown && (\n        <line\n          x1={0}\n          y1={0}\n          x2={0}\n          y2={yMax}\n          stroke={strokeColor}\n          strokeDasharray={strokeDasharray}\n        />\n      )}\n\n      {ticks.map((value, index) =>\n        (index > 0 || index < numTicks - 1) && value.valueOf() !== 0 ? (\n          // rome-ignore lint/suspicious/noArrayIndexKey: no better key available\n          <text key={index} x={0} y={yScale(value)} {...tickLabelProps}>\n            {formatter(value)}\n          </text>\n        ) : null,\n      )}\n    </g>\n  );\n}\n","import { animate, Tween, useMotionValue } from \"framer-motion\";\nimport {\n  memo,\n  useContext,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useState,\n} from \"react\";\n\nimport type { AbstractChart, Axis } from \"../../Mondrian\";\nimport { BottomAxis } from \"./BottomAxis\";\nimport { createLinearScaleForRange, Range } from \"../utils\";\nimport { GridColumns } from \"./GridColumns\";\nimport { GridRows } from \"./GridRows\";\nimport { LeftAxis } from \"./LeftAxis\";\nimport type { Scale, Scales, TickFormatters } from \"../types\";\nimport { ChartThemeContext } from \"../../theme\";\n\ntype Props = {\n  chart: AbstractChart<unknown, unknown>;\n  gridColumnsShown?: boolean;\n  gridRowsShown?: boolean;\n  gridBordersShown?: boolean;\n  gridDasharray?: string;\n  scales: Scales;\n  tickFormatters: TickFormatters;\n};\n\nexport const GridWithAxes = memo(function GridWithAxes({\n  chart,\n  gridColumnsShown = true,\n  gridRowsShown = true,\n  gridBordersShown = true,\n  gridDasharray,\n  scales,\n  tickFormatters,\n}: Props) {\n  const { xMax, xScale, yMax } = scales;\n\n  const { gridStrokeColor } = useContext(ChartThemeContext);\n\n  const { xAxis, yAxis } = chart;\n  const minValue = useCustomSpring(yAxis.minValue);\n  const maxValue = useCustomSpring(yAxis.maxValue);\n\n  const animatedScale = createLinearScaleForRangeWithCustomDomain(\n    [yMax, 0],\n    [minValue, maxValue],\n  );\n\n  const xTicks = useMemo(\n    () => getTicks(xAxis, xMax, xScale, 12, getMaxXTickValue),\n    [xAxis, xMax, xScale],\n  );\n  const yTicks = useMemo(\n    () => getTicks(yAxis, yMax, animatedScale, 8, getMaxYTickValue),\n    [yAxis, yMax, animatedScale],\n  );\n\n  return (\n    <>\n      {gridRowsShown && (\n        <GridRows\n          stroke={gridStrokeColor}\n          strokeDasharray={gridDasharray}\n          xMax={xMax}\n          yScale={animatedScale}\n          yTicks={yTicks}\n        />\n      )}\n      {gridBordersShown && (\n        <line\n          x1={xMax}\n          x2={xMax}\n          y1={0}\n          y2={yMax}\n          stroke={gridStrokeColor}\n          strokeDasharray={gridDasharray}\n        />\n      )}\n      {gridColumnsShown && (\n        <GridColumns\n          scales={scales}\n          stroke={gridStrokeColor}\n          strokeDasharray={gridDasharray}\n          xAxis={xAxis}\n          xTicks={xTicks}\n        />\n      )}\n      <BottomAxis\n        formatter={tickFormatters.xFormatter}\n        scales={scales}\n        strokeColor={gridStrokeColor}\n        strokeDasharray={gridDasharray}\n        ticks={xTicks}\n        xAxis={xAxis}\n      />\n      <LeftAxis\n        formatter={tickFormatters.yFormatter}\n        gridBordersShown={gridBordersShown}\n        scales={{ ...scales, yScale: animatedScale }}\n        strokeColor={gridStrokeColor}\n        strokeDasharray={gridDasharray}\n        ticks={yTicks}\n      />\n    </>\n  );\n});\n\ntype Domain = [min: number, max: number];\n\n/**\n * Creates a linear scale function for the given range, but uses a custom\n * domain.\n */\nfunction createLinearScaleForRangeWithCustomDomain(\n  range: Range,\n  [min, max]: Domain,\n): Scale {\n  const linearScale = createLinearScaleForRange(range);\n  return (value) => linearScale((value - min) / (max - min));\n}\n\nfunction getTicks(\n  axis: Axis,\n  max: number,\n  scale: Scale,\n  numTicks: number,\n  getMaxAllowedTick: (ticks: Array<number>, maxValue: number) => number,\n): Array<number> {\n  const suggestions = axis.tickSuggestions;\n  const { ticks, interval } = suggestions\n    ? getTicksAndIntervalFromSuggestions(axis, suggestions, numTicks)\n    : getTicksAndIntervalFromRange(axis.minValue, axis.maxValue, numTicks);\n\n  if (interval !== undefined) {\n    extendTicksToFitAxis(ticks, axis, max, scale, 2 * numTicks, interval);\n  }\n  removeLastTickIfTooCloseToMax(ticks, axis.maxValue, getMaxAllowedTick);\n\n  return ticks;\n}\n\nfunction getTicksAndIntervalFromRange(\n  minValue: number,\n  maxValue: number,\n  numTicks: number,\n): { ticks: Array<number>; interval?: number } {\n  const interval = (maxValue - minValue) / numTicks;\n\n  // NOTE - We need to handle the case where the interval is less than EPSILON,\n  //        which is the smallest interval we can represent with javascript's floating point precision\n  //        (see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/EPSILON)\n  if (interval < Number.EPSILON) {\n    return {\n      ticks: [minValue, maxValue],\n    };\n  }\n\n  const ticks = [minValue];\n  let tick = minValue + interval;\n\n  while (tick < maxValue) {\n    ticks.push(tick);\n    tick += interval;\n  }\n\n  return { ticks, interval };\n}\n\nfunction getTicksAndIntervalFromSuggestions(\n  axis: Axis,\n  suggestions: Array<number>,\n  numTicks: number,\n): { ticks: Array<number>; interval?: number } {\n  const len = suggestions.length;\n  if (len < 2) {\n    return { ticks: suggestions };\n  }\n\n  const suggestionInterval = suggestions[1] - suggestions[0];\n  const axisRange = axis.maxValue - axis.minValue;\n  const ticksPerRange = axisRange / suggestionInterval;\n  if (ticksPerRange < numTicks) {\n    return { ticks: suggestions, interval: suggestionInterval };\n  }\n\n  const ticks = [];\n  const divisionFactor = Math.ceil(ticksPerRange / numTicks);\n  for (let i = 0; i < len; i++) {\n    if (i % divisionFactor === 0) {\n      ticks.push(suggestions[i]);\n    }\n  }\n\n  return { ticks, interval: divisionFactor * suggestionInterval };\n}\n\n/**\n * Extends the ticks to cover the full range of the axis.\n *\n * Due to animations/translations it is possible the ticks don't yet cover the\n * full range of the axis. This function extends the ticks as necessary, and\n * also includes a slight margin to prevent a \"pop-in\" effect of suddenly\n * appearing tick labels from the right edge.\n *\n * @note This function mutates the input ticks.\n */\nfunction extendTicksToFitAxis(\n  ticks: Array<number>,\n  axis: Axis,\n  max: number,\n  scale: Scale,\n  maxTicks: number,\n  interval: number,\n) {\n  const scaleToAxis = (value: number) =>\n    scale((value - axis.minValue) / (axis.maxValue - axis.minValue));\n\n  // Trim ticks from the start if the user has dragged them beyond the Y axis.\n  while (ticks.length && scaleToAxis(ticks[0]) < 0) {\n    ticks.shift();\n  }\n\n  let preTick = ticks[0] - interval;\n  while (ticks.length < maxTicks && scaleToAxis(preTick) >= 0) {\n    ticks.unshift(preTick);\n    preTick -= interval;\n  }\n\n  let postTick = ticks[ticks.length - 1] + interval;\n  while (ticks.length < maxTicks && scaleToAxis(postTick) < 1.1 * max) {\n    ticks.push(postTick);\n    postTick += interval;\n  }\n}\n\nconst spring: Tween = {\n  type: \"tween\",\n  duration: 1,\n  easings: [\"anticipate\"],\n};\n\nfunction useCustomSpring(value: number) {\n  const motionValue = useMotionValue(value);\n  const [current, setCurrent] = useState(value);\n\n  useLayoutEffect(() => {\n    return motionValue.on(\"change\", (value) => setCurrent(value));\n  }, [motionValue]);\n\n  useEffect(() => {\n    const controls = animate(motionValue, value, spring);\n    return controls.stop;\n  }, [motionValue, value]);\n\n  return current;\n}\n\n/**\n * When rendering our svg charts, we want to avoid cutting off tick labels.\n * The way we can do this (simiar to visx's solution) is by not rendering ticks,\n * if they are too close to the axis's max value.\n *\n * The definition of what is \"too close\" to the max value\n * is determined by the `getMaxTickValue` function.\n *\n * @note This function mutates the input ticks.\n */\nconst removeLastTickIfTooCloseToMax = (\n  ticks: Array<number>,\n  maxValue: number,\n  getMaxAllowedTick: (ticks: Array<number>, maxValue: number) => number,\n) => {\n  if (ticks.length < 2) {\n    return;\n  }\n\n  const maxTickValue = getMaxAllowedTick(ticks, maxValue);\n\n  const lastTick = ticks[ticks.length - 1];\n  if (lastTick > maxTickValue) {\n    ticks.pop();\n  }\n};\n\n/**\n * Returns a maximum allowed tick value for the x-axis.\n *\n * Heuristic:\n *   If a tick's distance to the maxValue is within 1/2 the size of the tick-interval,\n *   the tick will get dropped.\n *\n * Note that the heuristic was determined by trial and error.\n */\nconst getMaxXTickValue = (ticks: Array<number>, maxValue: number) => {\n  if (ticks.length < 2) {\n    return maxValue;\n  }\n\n  const interval = ticks[1] - ticks[0];\n  return maxValue - interval / 2;\n};\n\n/**\n * Returns a maximum allowed tick value for the x-axis.\n *\n * Heuristic:\n *   If a tick's distance to the maxValue is within 1/3 the size of the tick-interval,\n *   the tick will get dropped.\n *\n * Note that the heuristic was determined by trial and error.\n */\nconst getMaxYTickValue = (ticks: Array<number>, maxValue: number) => {\n  if (ticks.length < 2) {\n    return maxValue;\n  }\n\n  const interval = ticks[1] - ticks[0];\n  return maxValue - interval / 3;\n};\n","import { useMemo, useReducer } from \"react\";\n\nimport { identity, isMac } from \"../../utils\";\n\ntype PressedKeyEvent = KeyboardEvent | React.MouseEvent;\n\nexport type InteractiveControls = {\n  resetMouseInteraction(): void;\n  startDrag(start: number): void;\n  startZoom(start: number): void;\n  updateEndValue(end: number): void;\n  updatePressedKeys(event: PressedKeyEvent): void;\n};\n\nexport type InteractiveControlsState = {\n  mouseInteraction: MouseInteractionState;\n  dragKeyPressed: boolean;\n  zoomKeyPressed: boolean;\n};\n\nexport type MouseInteractionState =\n  | { type: \"none\" }\n  | { type: \"drag\"; start: number; end?: number }\n  | { type: \"zoom\"; start: number; end?: number };\n\nconst defaultState: InteractiveControlsState = {\n  mouseInteraction: { type: \"none\" },\n  dragKeyPressed: false,\n  zoomKeyPressed: false,\n};\n\n/**\n * Returns zoom/drag handlers and state.\n */\nexport function useInteractiveControls(\n  readOnly: boolean,\n): InteractiveControls & InteractiveControlsState {\n  const [state, dispatch] = useReducer(\n    readOnly ? identity : controlsStateReducer,\n    defaultState,\n  );\n\n  const controls = useMemo(() => createControls(dispatch), []);\n\n  return { ...controls, ...state };\n}\n\ntype ActionDragStart = {\n  type: \"DRAG_START\";\n  payload: { start: number };\n};\n\ntype ActionReset = {\n  type: \"RESET_MOUSE_INTERACTION\";\n};\n\ntype ActionUpdateEndValue = {\n  type: \"UPDATE_END_VALUE\";\n  payload: { end: number };\n};\n\ntype ActionUpdatePressedKeys = {\n  type: \"UPDATE_PRESSED_KEYS\";\n  payload: {\n    dragKeyPressed?: boolean;\n    zoomKeyPressed?: boolean;\n  };\n};\n\ntype ActionZoomStart = {\n  type: \"ZOOM_START\";\n  payload: { start: number };\n};\n\ntype Actions =\n  | ActionDragStart\n  | ActionReset\n  | ActionUpdateEndValue\n  | ActionUpdatePressedKeys\n  | ActionZoomStart;\n\nfunction createControls(\n  dispatch: React.Dispatch<Actions>,\n): InteractiveControls {\n  return {\n    resetMouseInteraction() {\n      dispatch({ type: \"RESET_MOUSE_INTERACTION\" });\n    },\n\n    startDrag(start: number) {\n      dispatch({ type: \"DRAG_START\", payload: { start } });\n    },\n\n    startZoom(start: number) {\n      dispatch({ type: \"ZOOM_START\", payload: { start } });\n    },\n\n    updateEndValue(end: number) {\n      dispatch({ type: \"UPDATE_END_VALUE\", payload: { end } });\n    },\n\n    updatePressedKeys(event: PressedKeyEvent) {\n      dispatch({\n        type: \"UPDATE_PRESSED_KEYS\",\n        payload: {\n          dragKeyPressed: dragKeyPressed(event),\n          zoomKeyPressed: zoomKeyPressed(event),\n        },\n      });\n    },\n  };\n}\n\nfunction controlsStateReducer(\n  state: InteractiveControlsState,\n  action: Actions,\n): InteractiveControlsState {\n  switch (action.type) {\n    case \"DRAG_START\":\n      return {\n        ...state,\n        mouseInteraction: { type: \"drag\", start: action.payload.start },\n      };\n\n    case \"RESET_MOUSE_INTERACTION\":\n      return { ...state, mouseInteraction: defaultState.mouseInteraction };\n\n    case \"UPDATE_END_VALUE\":\n      if (state.mouseInteraction.type === \"none\") {\n        return state;\n      }\n\n      return {\n        ...state,\n        mouseInteraction: {\n          ...state.mouseInteraction,\n          end: action.payload.end,\n        },\n      };\n\n    case \"UPDATE_PRESSED_KEYS\":\n      return { ...state, ...action.payload };\n\n    case \"ZOOM_START\":\n      return {\n        ...state,\n        mouseInteraction: { type: \"zoom\", start: action.payload.start },\n      };\n\n    default:\n      return state;\n  }\n}\n\nfunction dragKeyPressed(event: PressedKeyEvent) {\n  return event.shiftKey;\n}\n\nfunction zoomKeyPressed(event: PressedKeyEvent) {\n  return isMac ? event.metaKey : event.ctrlKey;\n}\n","import type { Dimensions } from \"../types\";\nimport { getCoordinatesForEvent } from \"../utils\";\nimport type {\n  InteractiveControls,\n  InteractiveControlsState,\n} from \"./useInteractiveControls\";\nimport {\n  preventDefault,\n  secondsToTimestamp,\n  timestampToSeconds,\n} from \"../../utils\";\nimport type { TimeRange, Timestamp } from \"../../providerTypes\";\n\nconst MIN_DURATION = 60; // in seconds\n\ntype MouseControls = {\n  onMouseDown: React.MouseEventHandler<SVGElement>;\n  onMouseMove: React.MouseEventHandler<SVGElement>;\n  onMouseUp: React.MouseEventHandler<SVGElement>;\n  onWheel: (event: WheelEvent) => void;\n};\n\ntype Props = {\n  interactiveControls: InteractiveControls & InteractiveControlsState;\n  timeRange: TimeRange;\n  onChangeTimeRange?: (timeRange: TimeRange) => void;\n  dimensions: Dimensions;\n};\n\n/**\n * Hook for setting up mouse handlers to control dragging & zoom\n */\nexport function useMouseControls({\n  interactiveControls: {\n    dragKeyPressed,\n    zoomKeyPressed,\n    mouseInteraction,\n    resetMouseInteraction,\n    startDrag,\n    startZoom,\n    updateEndValue,\n  },\n  timeRange,\n  onChangeTimeRange,\n  dimensions,\n}: Props): MouseControls {\n  function onMouseDown(event: React.MouseEvent<SVGElement>) {\n    if (event.buttons !== 1 || !onChangeTimeRange) {\n      return;\n    }\n\n    preventDefault(event);\n\n    const coords = getCoordinatesForEvent(event, dimensions);\n    if (!coords) {\n      return;\n    }\n\n    if (dragKeyPressed) {\n      startDrag(coords.x);\n    } else if (zoomKeyPressed) {\n      startZoom(coords.x);\n    }\n  }\n\n  function onMouseMove(event: React.MouseEvent<SVGElement>) {\n    preventDefault(event);\n\n    if (mouseInteraction.type === \"none\") {\n      return;\n    }\n\n    if (\n      (mouseInteraction.type === \"drag\" && !dragKeyPressed) ||\n      (mouseInteraction.type === \"zoom\" && !zoomKeyPressed)\n    ) {\n      resetMouseInteraction();\n      return;\n    }\n\n    const coords = getCoordinatesForEvent(event, dimensions);\n    if (coords) {\n      updateEndValue(coords.x);\n    }\n  }\n\n  function onMouseUp(event: React.MouseEvent) {\n    if (event.button !== 0) {\n      return;\n    }\n\n    preventDefault(event);\n\n    if (mouseInteraction.type === \"zoom\") {\n      const { start, end } = mouseInteraction;\n      if (end !== undefined && start !== end) {\n        onChangeTimeRange?.({\n          from: coordinateToTimestamp(timeRange, Math.min(start, end)),\n          to: coordinateToTimestamp(timeRange, Math.max(start, end)),\n        });\n      }\n\n      resetMouseInteraction();\n    } else if (mouseInteraction.type === \"drag\") {\n      const { start, end } = mouseInteraction;\n      if (end !== undefined && start !== end) {\n        move(start - end);\n      }\n\n      resetMouseInteraction();\n    }\n  }\n\n  function onWheel(event: WheelEvent) {\n    if (mouseInteraction.type !== \"none\" || !zoomKeyPressed) {\n      return;\n    }\n\n    const coords = getCoordinatesForEvent(event, dimensions);\n    if (!coords) {\n      return;\n    }\n\n    preventDefault(event);\n\n    const factor = event.deltaY < 0 ? 0.5 : 2;\n    zoom(factor, coords.x);\n  }\n\n  /**\n   * Moves the time scale.\n   *\n   * @param deltaRatio The delta to move as a ratio of the current time scale\n   *                   window. -1 moves a full window to the left, and 1 moves\n   *                   a full window to the right.\n   */\n  function move(deltaRatio: number) {\n    const currentFrom = timestampToSeconds(timeRange.from);\n    const currentTo = timestampToSeconds(timeRange.to);\n    const delta = deltaRatio * (currentTo - currentFrom);\n    const from = secondsToTimestamp(currentFrom + delta);\n    const to = secondsToTimestamp(currentTo + delta);\n\n    onChangeTimeRange?.({ from, to });\n  }\n\n  /**\n   * Zooms into or out from the graph.\n   *\n   * @param factor The zoom factor. Anything below 1 makes the time scale\n   *               smaller (zooming in), and anything above 1 makes the time\n   *               scale larger (zooming out).\n   * @param focusRatio The horizontal point on which to focus the zoom,\n   *                   expressed as a ratio from 0 (left-hand side of the graph)\n   *                   to 1 (right-hand side of the graph).\n   */\n  function zoom(factor: number, focusRatio = 0.5) {\n    const currentFrom = timestampToSeconds(timeRange.from);\n    const currentTo = timestampToSeconds(timeRange.to);\n    const duration = currentTo - currentFrom;\n    const focusTimestamp = currentFrom + focusRatio * duration;\n    const newDuration = Math.max(duration * factor, MIN_DURATION);\n    const from = secondsToTimestamp(focusTimestamp - newDuration * focusRatio);\n    const to = secondsToTimestamp(\n      focusTimestamp + newDuration * (1 - focusRatio),\n    );\n\n    onChangeTimeRange?.({ from, to });\n  }\n\n  return { onMouseDown, onMouseMove, onMouseUp, onWheel };\n}\n\nfunction coordinateToTimestamp(timeRange: TimeRange, x: number): Timestamp {\n  const from = timestampToSeconds(timeRange.from);\n  const to = timestampToSeconds(timeRange.to);\n\n  return secondsToTimestamp(from + x * (to - from));\n}\n","import { useMemo } from \"react\";\n\nimport { createLinearScaleForRange, Range } from \"../utils\";\nimport type { Dimensions, Scales } from \"../types\";\nimport type { MouseInteractionState } from \"./useInteractiveControls\";\n\n/**\n * Returns the scales to use for rendering SVG components.\n *\n * Fortunately for us, our abstract charts are normalized along both axes to\n * values from 0.0 to 1.0, meaning we can suffice with trivial linear scales.\n *\n * If the chart is being dragged with the mouse, translation along the X axis\n * is applied.\n */\nexport function useScales(\n  { xMax, yMax }: Dimensions,\n  mouseInteraction: MouseInteractionState,\n): Scales {\n  // rome-ignore lint/nursery/useHookAtTopLevel: https://github.com/rome/tools/issues/4483\n  return useMemo(\n    () => ({\n      xMax,\n      yMax,\n      xScale: createLinearScaleForRange(\n        translatedRange(xMax, mouseInteraction),\n      ),\n      yScale: createLinearScaleForRange([yMax, 0]),\n    }),\n    [mouseInteraction, xMax, yMax],\n  );\n}\n\nfunction translatedRange(\n  xMax: number,\n  mouseInteraction: MouseInteractionState,\n): Range {\n  if (mouseInteraction.type === \"drag\") {\n    const { start, end } = mouseInteraction;\n    if (end !== undefined && start !== end) {\n      const delta = (end - start) * xMax;\n      return [delta, xMax + delta];\n    }\n  }\n\n  return [0, xMax];\n}\n","import { useEffect, useRef, useState } from \"react\";\n\nimport {\n  AbstractChart,\n  Area,\n  AreaPoint,\n  Line,\n  Point,\n  Rectangle,\n  Shape,\n} from \"../../Mondrian\";\nimport type {\n  ChartCoordinates,\n  CloseTooltipFn,\n  Dimensions,\n  ShowTooltipFn,\n  VirtualElement,\n} from \"../types\";\nimport { getCoordinatesForEvent } from \"../utils\";\nimport { MARGINS } from \"../constants\";\nimport { noop } from \"../../utils\";\nimport { useHandler } from \"../../hooks\";\n\nexport type GraphTooltip<S, P> = {\n  top: number;\n  left: number;\n  element: SVGSVGElement;\n  color: string;\n  sourcePoint: [S, P];\n};\n\ntype Props<S, P> = {\n  chart: AbstractChart<S, P>;\n  dimensions: Dimensions;\n  getShapeListColor: (source: S, index: number) => string;\n  showTooltip: ShowTooltipFn<S, P> | undefined;\n};\n\n/**\n * Handles the detection of where a tooltip should be shown.\n *\n * Should be passed a callback for showing the actual tooltip. If no callback\n * is passed, tooltips are disabled.\n */\nexport function useTooltip<S, P>(props: Props<S, P>) {\n  const [graphTooltip, setGraphTooltip] = useState<GraphTooltip<S, P> | null>(\n    null,\n  );\n\n  const closeFnRef = useRef<CloseTooltipFn | null>(null);\n\n  const showTooltipFn = props.showTooltip;\n  const showTooltip = showTooltipFn\n    ? (tip: GraphTooltip<S, P>) => {\n        setGraphTooltip(tip);\n\n        const element: VirtualElement = {\n          getBoundingClientRect: (): DOMRect => {\n            const ctm = tip.element.getScreenCTM();\n            const point = tip.element.createSVGPoint();\n            point.x = tip.left;\n            point.y = tip.top;\n\n            const { x, y } = ctm\n              ? point.matrixTransform(ctm)\n              : { x: tip.left, y: tip.top };\n\n            return new DOMRect(x - 4, y - 4, 8, 8);\n          },\n          contextElement: tip.element,\n        };\n\n        closeFnRef.current = showTooltipFn(element, tip.sourcePoint);\n      }\n    : noop;\n\n  const closeTooltip = useHandler(() => {\n    setGraphTooltip(null);\n\n    if (closeFnRef.current) {\n      closeFnRef.current();\n      closeFnRef.current = null;\n    }\n  });\n\n  useEffect(() => {\n    if (!showTooltipFn) {\n      closeTooltip();\n    }\n  }, [closeTooltip, showTooltipFn]);\n\n  return {\n    graphTooltip,\n\n    onMouseMove: (event: React.MouseEvent<SVGSVGElement>) => {\n      const closest = getClosestSeriesAndPointWithCoordinates(event, props);\n      if (!closest) {\n        return;\n      }\n\n      const [series, point, coords] = closest;\n\n      const { chart, dimensions, getShapeListColor } = props;\n      const shapeListIndex = chart.shapeLists.findIndex(\n        (shapeList) => shapeList.source === series,\n      );\n      const color = getShapeListColor(series, shapeListIndex);\n\n      showTooltip({\n        color,\n        element: event.currentTarget,\n        sourcePoint: [series, point],\n        top: (1 - coords.y) * dimensions.yMax + MARGINS.top,\n        left: coords.x * dimensions.xMax + MARGINS.left,\n      });\n    },\n\n    onMouseLeave: () => {\n      closeTooltip();\n    },\n  };\n}\n\n/**\n * Returns the closest coordinates where a tooltip should be displayed,\n * including the source series and point that were used to generate the shape\n * at those coordinates.\n */\nfunction getClosestSeriesAndPointWithCoordinates<S, P>(\n  event: React.MouseEvent<SVGElement>,\n  { chart, dimensions: scales }: Props<S, P>,\n): [S, P, ChartCoordinates] | null {\n  const coords = getCoordinatesForEvent(event, scales);\n  if (!coords) {\n    return null;\n  }\n\n  let closestSeriesAndPoint: [S, P, ChartCoordinates] | null = null;\n  let closestDistance: Distance = [Infinity, 0];\n  for (const shapeList of chart.shapeLists) {\n    for (const shape of shapeList.shapes) {\n      const closest = getClosestPointWithDistance(shape, coords);\n      if (!closest) {\n        continue;\n      }\n\n      const [point, closestCoords, distance] = closest;\n      if (isCloser(distance, closestDistance)) {\n        closestSeriesAndPoint = [shapeList.source, point, closestCoords];\n        closestDistance = distance;\n      }\n    }\n  }\n\n  return closestSeriesAndPoint;\n}\n\nfunction getClosestPointWithDistance<P>(\n  shape: Shape<P>,\n  coords: ChartCoordinates,\n): [P, ChartCoordinates, Distance] | null {\n  switch (shape.type) {\n    case \"area\":\n      return getClosestPointWithDistanceForArea(shape, coords);\n    case \"line\":\n      return getClosestPointWithDistanceForLine(shape, coords);\n    case \"point\":\n      return [shape.source, shape, getDistance(coords, shape)];\n    case \"rectangle\":\n      return getClosestPointWithDistanceForRectangle(shape, coords);\n  }\n}\n\nfunction getClosestPointWithDistanceForArea<P>(\n  area: Area<P>,\n  coords: ChartCoordinates,\n): [P, ChartCoordinates, Distance] | null {\n  const len = area.points.length;\n  if (len === 0) {\n    return null;\n  }\n\n  let closest: AreaPoint<P>;\n  let horizontalDistance: number;\n  if (coords.x < area.points[0].x) {\n    closest = area.points[0];\n    horizontalDistance = closest.x - coords.x;\n  } else if (coords.x > area.points[len - 1].x) {\n    closest = area.points[len - 1];\n    horizontalDistance = coords.x - closest.x;\n  } else {\n    closest = area.points[0];\n    horizontalDistance = coords.x - closest.x;\n    for (let i = 1; i < len; i++) {\n      const point = area.points[i];\n      const distance = Math.abs(point.x - coords.x);\n      if (distance < horizontalDistance) {\n        closest = point;\n        horizontalDistance = distance;\n      } else {\n        break;\n      }\n    }\n  }\n\n  let verticalDistance: number;\n  if (coords.y < closest.yMin) {\n    verticalDistance = closest.yMin - coords.y;\n  } else if (coords.y > closest.yMax) {\n    verticalDistance = coords.y - closest.yMax;\n  } else {\n    verticalDistance = 0;\n  }\n\n  return [\n    closest.source,\n    { x: closest.x, y: coords.y < closest.yMin ? closest.yMin : closest.yMax },\n    [horizontalDistance, verticalDistance],\n  ];\n}\n\nfunction getClosestPointWithDistanceForLine<P>(\n  line: Line<P>,\n  coords: ChartCoordinates,\n): [P, ChartCoordinates, Distance] | null {\n  let closestPoint: Point<P> | null = null;\n  let closestDistance: Distance = [Infinity, 0];\n  for (const point of line.points) {\n    const distance = getDistance(coords, point);\n    if (isCloser(distance, closestDistance)) {\n      closestPoint = point;\n      closestDistance = distance;\n    }\n  }\n\n  return closestPoint\n    ? [closestPoint.source, closestPoint, closestDistance]\n    : null;\n}\n\nfunction getClosestPointWithDistanceForRectangle<P>(\n  rectangle: Rectangle<P>,\n  coords: ChartCoordinates,\n): [P, ChartCoordinates, Distance] {\n  let horizontal: number;\n  if (coords.x < rectangle.x) {\n    horizontal = rectangle.x - coords.x;\n  } else if (coords.x > rectangle.x + rectangle.width) {\n    horizontal = coords.x - (rectangle.x + rectangle.width);\n  } else {\n    horizontal = 0;\n  }\n\n  let vertical: number;\n  if (coords.y < rectangle.y) {\n    vertical = rectangle.y - coords.y;\n  } else if (coords.y > rectangle.y + rectangle.height) {\n    vertical = coords.y - (rectangle.y + rectangle.height);\n  } else {\n    vertical = 0;\n  }\n\n  return [\n    rectangle.source,\n    {\n      x: rectangle.x + 0.5 * rectangle.width,\n      y: rectangle.y + rectangle.height,\n    },\n    [horizontal, vertical],\n  ];\n}\n\ntype Distance = [horizontal: number, vertical: number];\n\nfunction getDistance(p1: ChartCoordinates, p2: ChartCoordinates): Distance {\n  return [Math.abs(p1.x - p2.x), Math.abs(p1.y - p2.y)];\n}\n\n/**\n * Returns whether the given distance is closer than the given reference.\n *\n * Horizontal distance is prioritized over vertical distance.\n */\nfunction isCloser(distance: Distance, reference: Distance): boolean {\n  return (\n    distance[0] < reference[0] ||\n    (distance[0] === reference[0] && distance[1] < reference[1])\n  );\n}\n","import type { Dimensions } from \"./types\";\nimport type { MouseInteractionState } from \"./hooks\";\n\ntype Props = {\n  dimensions: Dimensions;\n  mouseInteraction: MouseInteractionState;\n};\n\nexport function ZoomBar({\n  dimensions: { xMax, yMax },\n  mouseInteraction,\n}: Props): JSX.Element | null {\n  if (mouseInteraction.type !== \"zoom\") {\n    return null;\n  }\n\n  const { start, end } = mouseInteraction;\n  if (end === undefined) {\n    return null;\n  }\n\n  const reverseZoom = end < start;\n\n  return (\n    <rect\n      stroke=\"#4797ff\"\n      fill=\"#a3cbff\"\n      fillOpacity=\"10%\"\n      x={(reverseZoom ? end : start) * xMax}\n      y={0}\n      width={(reverseZoom ? start - end : end - start) * xMax}\n      height={yMax}\n    />\n  );\n}\n","import { useContext, useEffect, useId, useMemo } from \"react\";\n\nimport { ChartContent } from \"./ChartContent\";\nimport { ChartSizeContext } from \"./ChartSizeContext\";\nimport type { CoreChartProps } from \"./types\";\nimport { GridWithAxes } from \"./GridWithAxes\";\nimport {\n  InteractiveControlsState,\n  useInteractiveControls,\n  useMouseControls,\n  useScales,\n  useTooltip,\n} from \"./hooks\";\nimport { ZoomBar } from \"./ZoomBar\";\nimport { CHART_SHAPE_OVERFLOW_MARGIN } from \"./constants\";\n\nexport function CoreChart<S, P>({\n  areaGradientShown = true,\n  chart,\n  getShapeListColor,\n  gridShown = true,\n  onChangeTimeRange,\n  readOnly = false,\n  showTooltip,\n  timeRange,\n  ...props\n}: CoreChartProps<S, P>): JSX.Element {\n  const interactiveControls = useInteractiveControls(readOnly);\n  const { mouseInteraction, updatePressedKeys } = interactiveControls;\n\n  const { width, height, xMax, yMax, marginTop, marginLeft } =\n    useContext(ChartSizeContext);\n  const dimensions = { xMax, yMax };\n\n  const {\n    onMouseDown,\n    onMouseUp,\n    onWheel,\n    onMouseMove: onMouseMoveControls,\n  } = useMouseControls({\n    dimensions,\n    interactiveControls,\n    onChangeTimeRange,\n    timeRange,\n  });\n\n  const {\n    graphTooltip,\n    onMouseMove: onMouseMoveTooltip,\n    onMouseLeave,\n  } = useTooltip({\n    chart,\n    dimensions,\n    getShapeListColor,\n    showTooltip: modifierPressed(interactiveControls) ? undefined : showTooltip,\n  });\n\n  const onMouseMove = (event: React.MouseEvent<SVGSVGElement>) => {\n    updatePressedKeys(event);\n    onMouseMoveControls(event);\n    onMouseMoveTooltip(event);\n  };\n\n  const clipPathId = useId();\n\n  const cursor = getCursorFromState(interactiveControls);\n\n  const scales = useScales(dimensions, mouseInteraction);\n\n  const tickFormatters = useMemo(() => {\n    return typeof props.tickFormatters === \"function\"\n      ? props.tickFormatters(chart.xAxis, chart.yAxis)\n      : props.tickFormatters;\n  }, [chart, props.tickFormatters]);\n\n  useEffect(() => {\n    const wheelListenerOptions: AddEventListenerOptions = { passive: false };\n    window.addEventListener(\"keydown\", updatePressedKeys);\n    window.addEventListener(\"keyup\", updatePressedKeys);\n    window.addEventListener(\"wheel\", onWheel, wheelListenerOptions);\n    return () => {\n      window.removeEventListener(\"keydown\", updatePressedKeys);\n      window.removeEventListener(\"keyup\", updatePressedKeys);\n      window.removeEventListener(\"wheel\", onWheel, wheelListenerOptions);\n    };\n  }, [onWheel, updatePressedKeys]);\n\n  const clipPathYStart = -1 * CHART_SHAPE_OVERFLOW_MARGIN;\n  const clipPathHeight = yMax + 2 * CHART_SHAPE_OVERFLOW_MARGIN;\n  // HACK - For spark charts, the clip path can be larger than the chart itself,\n  //        which leads to points getting cut off\n  const svgHeight = height > clipPathHeight ? height : clipPathHeight;\n\n  return (\n    // rome-ignore lint/a11y/noSvgWithoutTitle: title would interfere with tooltip\n    <svg\n      width={width}\n      height={svgHeight}\n      onMouseDown={onMouseDown}\n      onMouseMove={onMouseMove}\n      onMouseUp={onMouseUp}\n      onMouseLeave={onMouseLeave}\n      style={{ cursor, marginTop: 2 }}\n    >\n      <defs>\n        <clipPath id={clipPathId}>\n          <rect x={0} y={clipPathYStart} width={xMax} height={clipPathHeight} />\n        </clipPath>\n      </defs>\n      <g transform={`translate(${marginLeft}, ${marginTop})`}>\n        {gridShown && (\n          <GridWithAxes\n            {...props}\n            chart={chart}\n            scales={scales}\n            tickFormatters={tickFormatters}\n          />\n        )}\n        <g clipPath={`url(#${clipPathId})`}>\n          <ChartContent\n            {...props}\n            areaGradientShown={areaGradientShown}\n            chart={chart}\n            getShapeListColor={getShapeListColor}\n            scales={scales}\n          />\n        </g>\n        <ZoomBar dimensions={dimensions} mouseInteraction={mouseInteraction} />\n      </g>\n      {graphTooltip && (\n        <g>\n          <line\n            x1={graphTooltip.left}\n            y1={0}\n            x2={graphTooltip.left}\n            y2={yMax}\n            stroke={graphTooltip.color}\n            pointerEvents=\"none\"\n            strokeDasharray=\"1 1\"\n          />\n          <circle\n            cx={graphTooltip.left}\n            cy={graphTooltip.top}\n            r={4}\n            fill={graphTooltip.color}\n            pointerEvents=\"none\"\n          />\n        </g>\n      )}\n    </svg>\n  );\n}\n\nfunction modifierPressed(state: InteractiveControlsState): boolean {\n  return state.dragKeyPressed || state.zoomKeyPressed;\n}\n\nfunction getCursorFromState(state: InteractiveControlsState): string {\n  switch (state.mouseInteraction.type) {\n    case \"none\":\n      if (state.dragKeyPressed) {\n        return \"grab\";\n      }\n\n      if (state.zoomKeyPressed) {\n        return \"zoom-in\";\n      }\n\n      return \"default\";\n    case \"drag\":\n      return \"grabbing\";\n    case \"zoom\":\n      return \"zoom-in\";\n  }\n}\n","/**\n * Converts an RFC 3339-formatted timestamp to a time expressed in seconds since\n * the UNIX epoch.\n */\nexport function getTimeFromTimestamp(timestamp: string): number {\n  const time = new Date(timestamp).getTime() / 1000;\n  if (Number.isNaN(time)) {\n    throw new TypeError(`Invalid timestamp: ${timestamp}`);\n  }\n\n  return time;\n}\n","import { getTimeFromTimestamp } from \"./getTimeFromTimestamp\";\nimport type { Axis } from \"../../types\";\nimport type { Buckets } from \"../types\";\n\n/**\n * Adds suggestions to the axis based on the position of the first bucket and\n * the interval between buckets.\n *\n * @note This function mutates its input axis.\n */\nexport function attachSuggestionsToXAxis(\n  xAxis: Axis,\n  buckets: Buckets<unknown>,\n  interval: number,\n) {\n  if (interval <= 0) {\n    return;\n  }\n\n  const firstBucketTime = getFirstBucketTime(buckets);\n  if (!firstBucketTime) {\n    return;\n  }\n\n  const suggestions = [];\n\n  let suggestion = firstBucketTime;\n  while (suggestion < xAxis.maxValue) {\n    if (suggestion >= xAxis.minValue) {\n      suggestions.push(suggestion);\n    }\n\n    suggestion += interval;\n  }\n\n  xAxis.tickSuggestions = suggestions;\n}\n\nfunction getFirstBucketTime(buckets: Buckets<unknown>): number | undefined {\n  let firstBucketTimestamp: string | undefined;\n  for (const timestamp of buckets.keys()) {\n    if (!firstBucketTimestamp || timestamp < firstBucketTimestamp) {\n      firstBucketTimestamp = timestamp;\n    }\n  }\n\n  return firstBucketTimestamp\n    ? getTimeFromTimestamp(firstBucketTimestamp)\n    : undefined;\n}\n","export const BAR_PADDING = 0.2;\nexport const BAR_PLUS_PADDING = 1 + BAR_PADDING;\n","import type { Axis } from \"../../types\";\nimport { BAR_PLUS_PADDING } from \"../constants\";\n\n/**\n * Calculates the width of bars in bar charts.\n */\nexport function calculateBarWidth(\n  xAxis: Axis,\n  interval: number,\n  numBarsPerGroup: number,\n): number {\n  const numGroups =\n    interval === 0\n      ? 1\n      : Math.round((xAxis.maxValue - xAxis.minValue) / interval) + 1;\n  const numBars = numGroups * numBarsPerGroup;\n  return 1 / (numBars * BAR_PLUS_PADDING);\n}\n","import { BAR_PADDING, BAR_PLUS_PADDING } from \"../constants\";\n\nconst HALF_PADDING = 0.5 * BAR_PADDING;\n\n/**\n * Calculates the (left) X coordinate for a bar in a bar chart.\n *\n * `groupX` is the center coordinate for the bar group that contains all the\n * bars for a given bucket. `barWidth` is the width of an individual bar.\n *\n * `barIndex` and `numShapeLists` define the index of the bar within the group,\n * and how many bars may exist in the group in total, respectively.\n */\nexport function calculateBarX(\n  groupX: number,\n  barWidth: number,\n  barIndex: number,\n  numShapeLists: number,\n): number {\n  return (\n    groupX +\n    (barIndex - 0.5 * numShapeLists) * (barWidth * BAR_PLUS_PADDING) -\n    barWidth * HALF_PADDING\n  );\n}\n","import type { MinMax } from \"../types\";\n\n/**\n * Extends the given min-max, if necessary, with the given value.\n *\n * @note This function mutates its input min-max.\n */\nexport function extendMinMax(minMax: MinMax, value: number): MinMax {\n  if (value < minMax[0]) {\n    minMax[0] = value;\n  } else if (value > minMax[1]) {\n    minMax[1] = value;\n  }\n\n  return minMax;\n}\n","import type { MinMax } from \"../types\";\n\n/**\n * Returns the initial min-max based on a single value.\n */\nexport function getInitialMinMax(value: number): MinMax {\n  return [value, value];\n}\n","import type { Axis } from \"../../types\";\n\n/**\n * Returns the Y axis to display results if all results have the same value.\n *\n * For values larger than 1 or smaller than -1, the results will be centered\n * along the Y axis. For values closer to zero, the zero value is kept at the\n * bottom (for zero and positive values) or top (for negative values) of the\n * axis.\n */\nexport function getYAxisForConstantValue(value: number): Axis {\n  const tickSuggestions = [value];\n\n  if (value > 1 || value < -1) {\n    return { minValue: value - 1, maxValue: value + 1, tickSuggestions };\n  } else if (value >= 0) {\n    return { minValue: 0, maxValue: value + 1, tickSuggestions };\n  } else {\n    return { minValue: value - 1, maxValue: 0, tickSuggestions };\n  }\n}\n","import type { Axis } from \"../../types\";\nimport type { Buckets } from \"../types\";\nimport { extendMinMax } from \"./extendMinMax\";\nimport { getInitialMinMax } from \"./getInitialMinMax\";\nimport { getYAxisForConstantValue } from \"./getYAxisForConstantValue\";\n\n/**\n * Detects the range to display along the Y axis by looking at all the totals\n * inside the buckets.\n *\n * This function is used for stacked charts. When rendering a normal chart, use\n * `calculateYAxisRange()` instead.\n */\nexport function calculateStackedYAxisRange<T>(\n  buckets: Buckets<T>,\n  getTotalValue: (bucket: T) => number,\n): Axis {\n  if (buckets.size === 0) {\n    return getYAxisForConstantValue(0);\n  }\n\n  const minMax = getInitialMinMax(0);\n  for (const value of buckets.values()) {\n    extendMinMax(minMax, getTotalValue(value));\n  }\n\n  const [minValue, maxValue] = minMax;\n  if (minValue === maxValue) {\n    return getYAxisForConstantValue(minValue);\n  }\n\n  return { minValue, maxValue };\n}\n","import type { Buckets } from \"../types\";\nimport type { Timeseries } from \"../../../providerTypes\";\n\n/**\n * Creates buckets from timeseries, and reduces the metrics to calculated\n * values per bucket.\n *\n * For each unique timestamp encountered among the metrics, we create a new\n * bucket, while the value inside each bucket represents the reduced value for\n * all metrics matching that timestamp.\n */\nexport function createMetricBuckets<T>(\n  timeseriesData: Array<Timeseries>,\n  reducer: (current: T | undefined, metricValue: number) => T,\n  initialValue: void,\n): Buckets<T>;\nexport function createMetricBuckets<T>(\n  timeseriesData: Array<Timeseries>,\n  reducer: (current: T, metricValue: number) => T,\n  initialValue: T,\n): Buckets<T>;\nexport function createMetricBuckets<T>(\n  timeseriesData: Array<Timeseries>,\n  reducer: (current: T, metricValue: number) => T,\n  initialValue: T,\n): Buckets<T> {\n  const buckets = new Map<string, T>();\n\n  for (const timeseries of timeseriesData) {\n    if (!timeseries.visible) {\n      continue;\n    }\n\n    for (const { time, value } of timeseries.metrics) {\n      if (!Number.isNaN(value)) {\n        buckets.set(time, reducer(buckets.get(time) ?? initialValue, value));\n      }\n    }\n  }\n\n  return buckets;\n}\n","import type { Axis, TimeRange } from \"../../types\";\nimport { getTimeFromTimestamp } from \"./getTimeFromTimestamp\";\n\n/**\n * Returns the X axis to display results for the given time range.\n */\nexport function getXAxisFromTimeRange(timeRange: TimeRange): Axis {\n  return {\n    minValue: getTimeFromTimestamp(timeRange.from),\n    maxValue: getTimeFromTimestamp(timeRange.to),\n  };\n}\n","import type { StackedChartBucketValue } from \"../types\";\nimport type { TimeseriesSourceData } from \"../../types\";\nimport { calculateStackedYAxisRange } from \"./calculateStackedYAxisRange\";\nimport { createMetricBuckets } from \"./createMetricBuckets\";\nimport { getXAxisFromTimeRange } from \"./getXAxisFromTimeRange\";\n\n/**\n * Wrapper around `createMetricBuckets()` and axes creation specialized for\n * usage with stacked charts.\n */\nexport function calculateBucketsAndAxesForStackedChart(\n  input: TimeseriesSourceData,\n) {\n  const buckets = createMetricBuckets(\n    input.timeseriesData,\n    ({ currentY, total }, value) => ({ currentY, total: total + value }),\n    { currentY: 0, total: 0 } as StackedChartBucketValue,\n  );\n\n  const isPercentage = input.stackingType === \"percentage\";\n\n  const xAxis = getXAxisFromTimeRange(input.timeRange);\n  const yAxis = isPercentage\n    ? { minValue: 0, maxValue: 1 }\n    : calculateStackedYAxisRange(buckets, ({ total }) => total);\n\n  return { buckets, isPercentage, xAxis, yAxis };\n}\n","import type { Buckets } from \"../types\";\nimport { getTimeFromTimestamp } from \"./getTimeFromTimestamp\";\n\n/**\n * Calculates the smallest interval between any two timestamps present in the\n * given buckets.\n *\n * Returns `null` if there are insufficient timestamps to calculate an interval.\n */\nexport function calculateSmallestTimeInterval(\n  buckets: Buckets<unknown>,\n): number | null {\n  const timestamps = Array.from(buckets.keys(), getTimeFromTimestamp);\n  if (timestamps.length < 2) {\n    return null;\n  }\n\n  timestamps.sort();\n\n  let smallestInterval = Infinity;\n  for (let i = 1; i < timestamps.length; i++) {\n    const interval = timestamps[i] - timestamps[i - 1];\n    if (interval < smallestInterval) {\n      smallestInterval = interval;\n    }\n  }\n\n  return smallestInterval;\n}\n","import type { Axis } from \"../../types\";\nimport type { Buckets, MinMax } from \"../types\";\nimport { getYAxisForConstantValue } from \"./getYAxisForConstantValue\";\n\n/**\n * Detects the range to display along the Y axis by looking at all the min-max\n * values inside the buckets.\n *\n * When rendering a stacked chart, use `calculateStackedYAxisRange()` instead.\n */\nexport function calculateYAxisRange<T>(\n  buckets: Buckets<T>,\n  getMinMax: (bucket: T) => MinMax,\n): Axis {\n  const minMax = getBucketsMinMax(buckets, getMinMax);\n  if (!minMax) {\n    return getYAxisForConstantValue(0);\n  }\n\n  let [minValue, maxValue] = minMax;\n\n  if (minValue === maxValue) {\n    return getYAxisForConstantValue(minValue);\n  }\n\n  const distance = maxValue - minValue;\n  const margin = 0.05 * distance;\n\n  if (minValue < 0 || minValue >= margin) {\n    minValue -= margin;\n  } else {\n    minValue = 0;\n  }\n\n  if (maxValue > 0 || maxValue <= -margin) {\n    maxValue += margin;\n  } else {\n    maxValue = 0;\n  }\n\n  return { minValue, maxValue };\n}\n\nfunction getBucketsMinMax<T>(\n  buckets: Buckets<T>,\n  getMinMax: (bucketValue: T) => MinMax,\n): MinMax | undefined {\n  let minMax: MinMax | undefined;\n\n  for (const value of buckets.values()) {\n    const bucketMinMax = getMinMax(value);\n    if (!minMax) {\n      minMax = bucketMinMax;\n      continue;\n    }\n\n    if (bucketMinMax[0] < minMax[0]) {\n      minMax[0] = bucketMinMax[0];\n    }\n    if (bucketMinMax[1] > minMax[1]) {\n      minMax[1] = bucketMinMax[1];\n    }\n  }\n\n  return minMax;\n}\n","import type { Axis } from \"../../types\";\n\n/**\n * Extends the range of an axis with the given interval.\n *\n * The range of the interval is divided among ends of the axis. The purpose of\n * this is to extend the axis with enough space to display the bars for the\n * first and last buckets displayed on the bar chart.\n *\n * @note This function mutates its input axis.\n */\nexport function extendAxisWithInterval(axis: Axis, interval: number): Axis {\n  const halfInterval = 0.5 * interval;\n  axis.minValue -= halfInterval;\n  axis.maxValue += halfInterval;\n\n  return axis;\n}\n","import type { Axis } from \"../../types\";\n\n/**\n * Extends the range of the axis with the given value.\n *\n * If the given value is outside the range of the axis, the range is\n * extended to include the value. Otherwise, nothing happens.\n *\n * @note This function mutates its input axis.\n */\nexport function extendAxisWithValue(axis: Axis, value: number): Axis {\n  if (value < axis.minValue) {\n    axis.minValue = value;\n  } else if (value > axis.maxValue) {\n    axis.maxValue = value;\n  }\n\n  return axis;\n}\n","import type { Axis } from \"../../types\";\n\n/**\n * Takes an absolute value and normalizes it to a value between 0.0 and 1.0 for\n * the given axis.\n */\nexport function normalizeAlongLinearAxis(value: number, axis: Axis): number {\n  return (value - axis.minValue) / (axis.maxValue - axis.minValue);\n}\n","import type { Metric } from \"../../../providerTypes\";\nimport { getTimeFromTimestamp } from \"./getTimeFromTimestamp\";\n\n/**\n * Takes an array of metrics and divides it into a lines of metrics without\n * gaps.\n *\n * Any metric that has a `NaN` value, or that follows more than `1.5 * interval`\n * after the previous metric is considered to introduce a gap in the metrics.\n */\nexport function splitIntoContinuousLines(\n  metrics: Array<Metric>,\n  interval?: number,\n): Array<Array<Metric>> {\n  const lines: Array<Array<Metric>> = [];\n  let currentLine: Array<Metric> = [];\n  let previousTime: number | null = null;\n\n  for (const metric of metrics) {\n    if (Number.isNaN(metric.value)) {\n      if (currentLine.length > 0) {\n        lines.push(currentLine);\n        currentLine = [];\n      }\n\n      continue;\n    }\n\n    const newTime = getTimeFromTimestamp(metric.time);\n    if (previousTime && interval && newTime - previousTime > 1.5 * interval) {\n      if (currentLine.length > 0) {\n        lines.push(currentLine);\n      }\n\n      currentLine = [metric];\n    } else {\n      currentLine.push(metric);\n    }\n\n    previousTime = newTime;\n  }\n\n  if (currentLine.length > 0) {\n    lines.push(currentLine);\n  }\n\n  return lines;\n}\n","import type {\n  AbstractChart,\n  Axis,\n  Shape,\n  ShapeList,\n  TimeseriesSourceData,\n} from \"../types\";\nimport {\n  attachSuggestionsToXAxis,\n  calculateBarWidth,\n  calculateBarX,\n  calculateSmallestTimeInterval,\n  calculateYAxisRange,\n  createMetricBuckets,\n  extendAxisWithInterval,\n  extendAxisWithValue,\n  extendMinMax,\n  getInitialMinMax,\n  getTimeFromTimestamp,\n  getXAxisFromTimeRange,\n  normalizeAlongLinearAxis,\n} from \"./utils\";\nimport { compact, identity } from \"../../utils\";\nimport type { Metric, Timeseries } from \"../../providerTypes\";\nimport type { MinMax } from \"./types\";\n\nexport function generateBarChartFromTimeseries(\n  input: TimeseriesSourceData,\n): AbstractChart<Timeseries, Metric> {\n  const visibleTimeseriesData = input.timeseriesData.filter(\n    (timeseries) => timeseries.visible,\n  );\n\n  const buckets = createMetricBuckets(\n    visibleTimeseriesData,\n    (maybeMinMax: MinMax | undefined, value) =>\n      maybeMinMax ? extendMinMax(maybeMinMax, value) : getInitialMinMax(value),\n  );\n\n  const xAxis = getXAxisFromTimeRange(input.timeRange);\n  const yAxis = calculateYAxisRange(buckets, identity);\n\n  for (const value of input.additionalValues) {\n    extendAxisWithValue(yAxis, value);\n  }\n\n  const numShapeLists = visibleTimeseriesData.length;\n\n  const interval = calculateSmallestTimeInterval(buckets);\n  if (interval) {\n    extendAxisWithInterval(xAxis, interval);\n    attachSuggestionsToXAxis(xAxis, buckets, interval);\n  }\n\n  const barWidth = calculateBarWidth(xAxis, interval ?? 0, numShapeLists);\n  const barArgs: BarArgs = { barWidth, numShapeLists, xAxis, yAxis };\n\n  const shapeLists: Array<ShapeList<Timeseries, Metric>> =\n    input.timeseriesData.map((timeseries) => ({\n      shapes: timeseries.visible\n        ? compact(\n            timeseries.metrics.map((metric) =>\n              getBarShape(\n                metric,\n                visibleTimeseriesData.indexOf(timeseries),\n                barArgs,\n              ),\n            ),\n          )\n        : [],\n      source: timeseries,\n    }));\n\n  return { shapeLists, xAxis, yAxis };\n}\n\ntype BarArgs = {\n  barWidth: number;\n  numShapeLists: number;\n  xAxis: Axis;\n  yAxis: Axis;\n};\n\nfunction getBarShape(\n  metric: Metric,\n  barIndex: number,\n  { xAxis, yAxis, barWidth, numShapeLists: numVisibleTimeseries }: BarArgs,\n): Shape<Metric> | null {\n  if (Number.isNaN(metric.value)) {\n    return null;\n  }\n\n  const groupX = normalizeAlongLinearAxis(\n    getTimeFromTimestamp(metric.time),\n    xAxis,\n  );\n  return {\n    type: \"rectangle\",\n    x: calculateBarX(groupX, barWidth, barIndex, numVisibleTimeseries),\n    width: barWidth,\n    y: 0,\n    height: normalizeAlongLinearAxis(metric.value, yAxis),\n    source: metric,\n  };\n}\n","import type {\n  AbstractChart,\n  Axis,\n  Point,\n  Shape,\n  ShapeList,\n  TimeseriesSourceData,\n} from \"../types\";\nimport {\n  attachSuggestionsToXAxis,\n  calculateSmallestTimeInterval,\n  calculateYAxisRange,\n  createMetricBuckets,\n  extendMinMax,\n  extendAxisWithValue,\n  getInitialMinMax,\n  getTimeFromTimestamp,\n  getXAxisFromTimeRange,\n  normalizeAlongLinearAxis,\n  splitIntoContinuousLines,\n} from \"./utils\";\nimport { identity } from \"../../utils\";\nimport type { Metric, Timeseries } from \"../../providerTypes\";\nimport type { MinMax } from \"./types\";\n\nexport function generateLineChartFromTimeseries(\n  input: TimeseriesSourceData,\n): AbstractChart<Timeseries, Metric> {\n  const buckets = createMetricBuckets(\n    input.timeseriesData,\n    (maybeMinMax: MinMax | undefined, value) =>\n      maybeMinMax ? extendMinMax(maybeMinMax, value) : getInitialMinMax(value),\n  );\n\n  const xAxis = getXAxisFromTimeRange(input.timeRange);\n  const yAxis = calculateYAxisRange(buckets, identity);\n\n  for (const value of input.additionalValues) {\n    extendAxisWithValue(yAxis, value);\n  }\n\n  const interval = calculateSmallestTimeInterval(buckets);\n  if (interval) {\n    attachSuggestionsToXAxis(xAxis, buckets, interval);\n  }\n\n  const shapeLists: Array<ShapeList<Timeseries, Metric>> =\n    input.timeseriesData.map((timeseries) => ({\n      shapes: timeseries.visible\n        ? getShapes(timeseries.metrics, xAxis, yAxis, interval)\n        : [],\n      source: timeseries,\n    }));\n\n  return { shapeLists, xAxis, yAxis };\n}\n\nfunction getShapes(\n  metrics: Array<Metric>,\n  xAxis: Axis,\n  yAxis: Axis,\n  interval: number | null,\n): Array<Shape<Metric>> {\n  switch (metrics.length) {\n    case 0:\n      return [];\n    case 1: {\n      const metric = metrics[0];\n      return Number.isNaN(metric.value)\n        ? []\n        : [\n            {\n              type: \"point\",\n              ...getPointForMetric(metric, xAxis, yAxis),\n            },\n          ];\n    }\n    default: {\n      const lines = splitIntoContinuousLines(metrics, interval ?? undefined);\n      return lines.map((line) =>\n        // If the line only containes one metric value, render it as a point\n        // Otherwise, render a line\n        line.length === 1\n          ? {\n              type: \"point\",\n              ...getPointForMetric(line[0], xAxis, yAxis),\n            }\n          : {\n              type: \"line\",\n              points: line.map((metric) =>\n                getPointForMetric(metric, xAxis, yAxis),\n              ),\n            },\n      );\n    }\n  }\n}\n\nfunction getPointForMetric(\n  metric: Metric,\n  xAxis: Axis,\n  yAxis: Axis,\n): Point<Metric> {\n  const time = getTimeFromTimestamp(metric.time);\n\n  return {\n    x: normalizeAlongLinearAxis(time, xAxis),\n    y: normalizeAlongLinearAxis(metric.value, yAxis),\n    source: metric,\n  };\n}\n","import type { Axis, SeriesSource, ShapeList } from \"../types\";\nimport type { ProviderEvent } from \"../../providerTypes\";\nimport { getTimeFromTimestamp } from \"./utils\";\n\nexport function generateShapeListFromEvents(\n  { minValue, maxValue }: Axis,\n  events: Array<ProviderEvent>,\n): ShapeList<SeriesSource, ProviderEvent> {\n  return {\n    shapes: events.map((event) => {\n      const x =\n        (getTimeFromTimestamp(event.time) - minValue) / (maxValue - minValue);\n      return {\n        type: \"area\",\n        points: [{ x, yMin: 0, yMax: 1, source: event }],\n        strokeDasharray: [2],\n      };\n    }),\n    source: { type: \"events\" },\n  };\n}\n","import type { Axis, SeriesSource, ShapeList } from \"../types\";\nimport { normalizeAlongLinearAxis } from \"./utils\";\n\nexport function generateShapeListFromTargetLatency(\n  yAxis: Axis,\n  value: number,\n): ShapeList<SeriesSource, null> {\n  return {\n    shapes: [\n      {\n        type: \"line\",\n        points: [\n          { x: 0, y: normalizeAlongLinearAxis(value, yAxis), source: null },\n          { x: 1, y: normalizeAlongLinearAxis(value, yAxis), source: null },\n        ],\n      },\n    ],\n    source: { type: \"target_latency\" },\n  };\n}\n","import type {\n  AbstractChart,\n  Axis,\n  TimeseriesSourceData,\n  Shape,\n  ShapeList,\n} from \"../types\";\nimport {\n  calculateBucketsAndAxesForStackedChart,\n  calculateBarWidth,\n  calculateSmallestTimeInterval,\n  extendAxisWithInterval,\n  extendAxisWithValue,\n  getTimeFromTimestamp,\n  normalizeAlongLinearAxis,\n  attachSuggestionsToXAxis,\n} from \"./utils\";\nimport { compact } from \"../../utils\";\nimport type { Metric, Timeseries } from \"../../providerTypes\";\nimport type { StackedChartBuckets } from \"./types\";\n\nexport function generateStackedBarChartFromTimeseries(\n  input: TimeseriesSourceData,\n): AbstractChart<Timeseries, Metric> {\n  const { buckets, isPercentage, xAxis, yAxis } =\n    calculateBucketsAndAxesForStackedChart(input);\n\n  for (const value of input.additionalValues) {\n    extendAxisWithValue(yAxis, value);\n  }\n\n  const interval = calculateSmallestTimeInterval(buckets);\n  if (interval) {\n    extendAxisWithInterval(xAxis, interval);\n    attachSuggestionsToXAxis(xAxis, buckets, interval);\n  }\n\n  const barWidth = calculateBarWidth(xAxis, interval ?? 0, 1);\n  const barArgs: BarArgs = { barWidth, buckets, isPercentage, xAxis, yAxis };\n\n  const shapeLists: Array<ShapeList<Timeseries, Metric>> =\n    input.timeseriesData.map((timeseries) => ({\n      shapes: timeseries.visible\n        ? compact(\n            timeseries.metrics.map((metric) => getBarShape(metric, barArgs)),\n          )\n        : [],\n      source: timeseries,\n    }));\n\n  return { shapeLists, xAxis, yAxis };\n}\n\ntype BarArgs = {\n  barWidth: number;\n  buckets: StackedChartBuckets;\n  isPercentage: boolean;\n  xAxis: Axis;\n  yAxis: Axis;\n};\n\nfunction getBarShape(\n  metric: Metric,\n  { xAxis, yAxis, barWidth, isPercentage, buckets }: BarArgs,\n): Shape<Metric> | null {\n  const bucketValue = buckets.get(metric.time);\n  if (!bucketValue || Number.isNaN(metric.value)) {\n    return null;\n  }\n\n  const time = getTimeFromTimestamp(metric.time);\n  const value = isPercentage ? metric.value / bucketValue.total : metric.value;\n\n  const x = normalizeAlongLinearAxis(time, xAxis) - 0.5 * barWidth;\n  const y = bucketValue.currentY;\n\n  const height = normalizeAlongLinearAxis(value, yAxis);\n  bucketValue.currentY += height;\n\n  return { type: \"rectangle\", x, y, width: barWidth, height, source: metric };\n}\n","import type {\n  AbstractChart,\n  AreaPoint,\n  Shape,\n  ShapeList,\n  TimeseriesSourceData,\n} from \"../types\";\nimport {\n  attachSuggestionsToXAxis,\n  calculateBucketsAndAxesForStackedChart,\n  calculateSmallestTimeInterval,\n  extendAxisWithValue,\n  getTimeFromTimestamp,\n  normalizeAlongLinearAxis,\n  splitIntoContinuousLines,\n} from \"./utils\";\nimport { compact } from \"../../utils\";\nimport type { Metric, Timeseries } from \"../../providerTypes\";\n\ntype AxesAndBuckets = ReturnType<typeof calculateBucketsAndAxesForStackedChart>;\n\nexport function generateStackedLineChartFromTimeseries(\n  input: TimeseriesSourceData,\n): AbstractChart<Timeseries, Metric> {\n  const axesAndBuckets = calculateBucketsAndAxesForStackedChart(input);\n  const { buckets, xAxis, yAxis } = axesAndBuckets;\n\n  for (const value of input.additionalValues) {\n    extendAxisWithValue(yAxis, value);\n  }\n\n  const interval = calculateSmallestTimeInterval(buckets);\n  if (interval) {\n    attachSuggestionsToXAxis(xAxis, buckets, interval);\n  }\n\n  const shapeLists: Array<ShapeList<Timeseries, Metric>> =\n    input.timeseriesData.map((timeseries) => ({\n      shapes: timeseries.visible\n        ? getShapes(timeseries.metrics, axesAndBuckets, interval)\n        : [],\n      source: timeseries,\n    }));\n\n  return { shapeLists, xAxis, yAxis };\n}\n\nfunction getShapes(\n  metrics: Array<Metric>,\n  axesAndBuckets: AxesAndBuckets,\n  interval: number | null,\n): Array<Shape<Metric>> {\n  const lines = splitIntoContinuousLines(metrics, interval ?? undefined);\n  return lines.map((line) => ({\n    type: \"area\",\n    points: compact(\n      line.map((metric) => getPointForMetric(metric, axesAndBuckets)),\n    ),\n  }));\n}\n\nfunction getPointForMetric(\n  metric: Metric,\n  { buckets, isPercentage, xAxis, yAxis }: AxesAndBuckets,\n): AreaPoint<Metric> | null {\n  const bucketValue = buckets.get(metric.time);\n  if (!bucketValue) {\n    return null;\n  }\n\n  const time = getTimeFromTimestamp(metric.time);\n  const value = isPercentage ? metric.value / bucketValue.total : metric.value;\n\n  const yMin = bucketValue.currentY;\n  const yMax = yMin + normalizeAlongLinearAxis(value, yAxis);\n  bucketValue.currentY = yMax;\n\n  return {\n    x: normalizeAlongLinearAxis(time, xAxis),\n    yMin,\n    yMax,\n    source: metric,\n  };\n}\n","import type {\n  AbstractChart,\n  SeriesSource,\n  CombinedSourceData,\n  TimeseriesSourceData,\n} from \"../types\";\nimport { generateBarChartFromTimeseries } from \"./generateBarChartFromTimeseries\";\nimport { generateLineChartFromTimeseries } from \"./generateLineChartFromTimeseries\";\nimport { generateShapeListFromEvents } from \"./generateShapeListFromEvents\";\nimport { generateShapeListFromTargetLatency } from \"./generateShapeListFromTargetLatency\";\nimport { generateStackedBarChartFromTimeseries } from \"./generateStackedBarChartFromTimeseries\";\nimport { generateStackedLineChartFromTimeseries } from \"./generateStackedLineChartFromTimeseries\";\nimport type { Timeseries, Metric, ProviderEvent } from \"../../providerTypes\";\n\n/**\n * Generates an abstract chart from a combination of timeseries data, events and\n * an optional target latency.\n */\nexport function generate({\n  graphType,\n  stackingType,\n  timeseriesData,\n  events,\n  targetLatency,\n  timeRange,\n}: CombinedSourceData): AbstractChart<\n  SeriesSource,\n  Metric | ProviderEvent | null\n> {\n  const timeseriesChart = generateFromTimeseries({\n    graphType,\n    stackingType,\n    timeseriesData,\n    timeRange,\n    additionalValues: targetLatency ? [targetLatency] : [],\n  });\n\n  const chart: AbstractChart<SeriesSource, Metric | ProviderEvent | null> = {\n    ...timeseriesChart,\n    shapeLists: timeseriesChart.shapeLists.map((list) => ({\n      ...list,\n      source: { ...list.source, type: \"timeseries\" },\n    })),\n  };\n\n  if (graphType === \"line\" && events.length > 0) {\n    chart.shapeLists.push(generateShapeListFromEvents(chart.xAxis, events));\n  }\n\n  if (targetLatency) {\n    chart.shapeLists.push(\n      generateShapeListFromTargetLatency(chart.yAxis, targetLatency),\n    );\n  }\n\n  return chart;\n}\n\n/**\n * Generates an abstract chart from the given timeseries data.\n */\nexport function generateFromTimeseries(\n  input: TimeseriesSourceData,\n): AbstractChart<Timeseries, Metric> {\n  if (input.graphType === \"line\") {\n    return input.stackingType === \"none\"\n      ? generateLineChartFromTimeseries(input)\n      : generateStackedLineChartFromTimeseries(input);\n  } else {\n    return input.stackingType === \"none\"\n      ? generateBarChartFromTimeseries(input)\n      : generateStackedBarChartFromTimeseries(input);\n  }\n}\n","import { Fragment, memo, useContext, useLayoutEffect } from \"react\";\nimport styled, { css } from \"styled-components\";\n\nimport { Container, Icon } from \"../BaseComponents\";\nimport { isMac, noop, preventDefault, sortBy } from \"../utils\";\nimport type { Timeseries } from \"../providerTypes\";\nimport type { ToggleTimeseriesEvent } from \"./types\";\nimport { useMeasure } from \"../hooks\";\nimport { ChartThemeContext } from \"../theme\";\nimport { WithChartTheme } from \"../chartThemeTypes\";\n\ntype Props = {\n  color: string;\n  index: number;\n  onHover: () => void;\n  onToggleTimeseriesVisibility?: (event: ToggleTimeseriesEvent) => void;\n  readOnly: boolean;\n  setSize: (index: number, value: number) => void;\n  style: React.CSSProperties;\n  timeseries: Timeseries;\n  uniqueKeys: Array<string>;\n};\n\nexport function TimeseriesLegendItem({\n  color,\n  onHover,\n  onToggleTimeseriesVisibility,\n  readOnly,\n  index,\n  setSize,\n  style,\n  timeseries,\n  uniqueKeys,\n}: Props): JSX.Element {\n  const [ref, { height }] = useMeasure<HTMLDivElement>();\n\n  useLayoutEffect(() => {\n    if (height) {\n      setSize(index, height);\n    }\n  }, [height, setSize, index]);\n\n  const toggleTimeseriesVisibility =\n    onToggleTimeseriesVisibility && !readOnly\n      ? (event: React.MouseEvent | React.KeyboardEvent) => {\n          preventDefault(event);\n          const toggleSingle = isMac ? event.metaKey : event.ctrlKey;\n          onToggleTimeseriesVisibility({\n            timeseries,\n            toggleOthers: !toggleSingle,\n          });\n        }\n      : noop;\n\n  const onKeyDown = (event: React.KeyboardEvent) => {\n    if (event.key === \"Space\") {\n      toggleTimeseriesVisibility(event);\n    }\n  };\n\n  const chartTheme = useContext(ChartThemeContext);\n\n  return (\n    <div\n      ref={ref}\n      style={style}\n      onClick={toggleTimeseriesVisibility}\n      onKeyDown={onKeyDown}\n    >\n      <LegendItemContainer\n        $chartTheme={chartTheme}\n        onMouseOver={timeseries.visible ? onHover : noop}\n        interactive={!readOnly && onToggleTimeseriesVisibility !== undefined}\n      >\n        <ColorBlock\n          $chartTheme={chartTheme}\n          color={color}\n          selected={timeseries.visible}\n        >\n          {timeseries.visible && <Icon type=\"check\" width=\"12\" height=\"12\" />}\n        </ColorBlock>\n        <FormattedTimeseries metric={timeseries} emphasizedKeys={uniqueKeys} />\n      </LegendItemContainer>\n    </div>\n  );\n}\n\nconst FormattedTimeseries = memo(function FormattedTimeseries({\n  metric,\n  emphasizedKeys = [],\n}: {\n  metric: Timeseries;\n  emphasizedKeys?: Array<string>;\n}): JSX.Element {\n  const { name, labels } = metric;\n\n  const labelEntries = sortBy(Object.entries(labels), ([key]) => key);\n\n  const chartTheme = useContext(ChartThemeContext);\n\n  return (\n    <Text>\n      {name && `${name}: `}\n      {labelEntries.map(([key, value], index) => (\n        <Fragment key={key}>\n          {index > 0 && \", \"}\n          <span className={key in emphasizedKeys ? \"emphasize\" : \"\"}>\n            {key}\n            {value && [\n              \": \",\n              emphasizedKeys.includes(key) ? (\n                <Emphasis $chartTheme={chartTheme} key={key}>\n                  {value}\n                </Emphasis>\n              ) : (\n                value\n              ),\n            ]}\n          </span>\n        </Fragment>\n      ))}\n    </Text>\n  );\n});\n\nconst ColorBlock = styled.div<\n  WithChartTheme & { color: string; selected: boolean }\n>(\n  ({ $chartTheme, color, selected }) => css`\n    background: ${selected ? color : \"transparent\"};\n    border: 2px solid ${color};\n    width: 14px;\n    height: 14px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: ${$chartTheme.legendItemCheckboxColor};\n    border-radius: ${$chartTheme.legendItemCheckboxBorderRadius};\n  `,\n);\n\nconst Emphasis = styled.span<WithChartTheme>(\n  ({ $chartTheme }) => css`\n    background-color: ${$chartTheme.legendItemEmphasisBackgroundColor};\n    color: ${$chartTheme.legendItemEmphasisColor};\n    font: ${$chartTheme.legendItemEmphasisFont};\n    border-radius: ${$chartTheme.legendItemEmphasisBorderRadius};\n    padding: 1px 4px;\n    display: inline-block;\n  `,\n);\n\nconst LegendItemContainer = styled(Container)<\n  WithChartTheme & { interactive: boolean }\n>(\n  ({ $chartTheme, interactive }) => css`\n    border-radius: ${$chartTheme.legendItemBorderRadius};\n    display: flex;\n    align-items: center;\n    font: ${$chartTheme.legendItemFont};\n    color: ${$chartTheme.legendItemColor};\n    padding: 8px 8px 8px 14px;\n    gap: 10px;\n    word-wrap: anywhere;\n\n    ${\n      interactive &&\n      css`\n        cursor: pointer;\n\n        &:hover {\n            background: ${$chartTheme.legendItemOnHoverBackgroundColor};\n            color: ${$chartTheme.legendItemOnHoverColor};\n        }\n      `\n    }\n  `,\n);\n\nconst Text = styled.div`\n  flex: 1;\n`;\n","import styled, { css } from \"styled-components\";\nimport { useContext, useEffect, useMemo, useRef } from \"react\";\nimport { VariableSizeList } from \"react-window\";\n\nimport { TimeseriesLegendItem } from \"./TimeseriesLegendItem\";\nimport type { TimeseriesLegendProps } from \"./types\";\nimport { Container } from \"../BaseComponents\";\nimport { findUniqueKeys, noop } from \"../utils\";\nimport type { ShapeList } from \"../Mondrian\";\nimport type { Timeseries } from \"../providerTypes\";\nimport { useExpandable, useForceUpdate, useHandler } from \"../hooks\";\nimport { ChartThemeContext } from \"../theme\";\n\nconst DEFAULT_HEIGHT = 293;\nconst DEFAULT_SIZE = 30;\nconst EXPANDED_HEIGHT = 592;\n\nexport function TimeseriesLegend<S extends Timeseries, P>({\n  footerShown = true,\n  getShapeListColor,\n  onFocusedShapeListChange,\n  onToggleTimeseriesVisibility,\n  readOnly = false,\n  shapeLists,\n}: TimeseriesLegendProps<S, P>) {\n  const { expandButton, gradient, isExpanded, onScroll, ref } =\n    useExpandable<HTMLDivElement>({ defaultHeight: DEFAULT_HEIGHT });\n\n  const maxHeight = isExpanded ? EXPANDED_HEIGHT : DEFAULT_HEIGHT;\n\n  const timeseriesData = useMemo(\n    () => shapeLists.map((shapeList) => shapeList.source),\n    [shapeLists],\n  );\n  const numSeries = timeseriesData.length;\n  const resultsText = `${numSeries} result${numSeries === 1 ? \"\" : \"s\"}`;\n\n  const uniqueKeys = useMemo(\n    () => findUniqueKeys(timeseriesData),\n    [timeseriesData],\n  );\n  const listRef = useRef<VariableSizeList<Array<ShapeList<S, P>>>>(null);\n  const sizeMap = useRef(new Map<number, number>());\n  const heightRef = useRef(timeseriesData.length * DEFAULT_SIZE);\n  const update = useForceUpdate();\n\n  useEffect(() => {\n    sizeMap.current = new Map();\n    heightRef.current = timeseriesData.length * DEFAULT_SIZE;\n    update();\n  }, [timeseriesData, update]);\n\n  const getSize = (index: number) => sizeMap.current.get(index) ?? DEFAULT_SIZE;\n\n  const setSize = useHandler((index: number, size: number) => {\n    const oldSize = getSize(index);\n    if (oldSize === size) {\n      return;\n    }\n\n    sizeMap.current.set(index, size);\n    listRef.current?.resetAfterIndex(index);\n    heightRef.current += size - oldSize;\n\n    if (heightRef.current < maxHeight) {\n      update();\n    }\n  });\n\n  const onMouseOut = () => onFocusedShapeListChange?.(null);\n\n  const setFocusedTimeseries = onFocusedShapeListChange\n    ? (timeseries: Timeseries) => {\n        const shapeList = shapeLists.find(\n          (shapeList) => shapeList.source === timeseries,\n        );\n        if (shapeList) {\n          onFocusedShapeListChange(shapeList);\n        }\n      }\n    : noop;\n\n  type RenderProps = {\n    data: Array<ShapeList<S, P>>;\n    index: number;\n    style: React.CSSProperties;\n  };\n\n  const render = useHandler(({ data, index, style }: RenderProps) => {\n    const shapeList = data[index];\n    const timeseries = shapeList.source;\n    return (\n      timeseries && (\n        <TimeseriesLegendItem\n          color={getShapeListColor(shapeList.source, index)}\n          onHover={() => setFocusedTimeseries(timeseries)}\n          onToggleTimeseriesVisibility={onToggleTimeseriesVisibility}\n          readOnly={readOnly}\n          timeseries={timeseries}\n          uniqueKeys={uniqueKeys}\n          index={index}\n          setSize={setSize}\n          style={style}\n        />\n      )\n    );\n  });\n\n  return (\n    <ChartLegendContainer onMouseOut={onMouseOut}>\n      <VariableSizeList\n        estimatedItemSize={DEFAULT_HEIGHT}\n        height={Math.min(heightRef.current, maxHeight)}\n        onScroll={onScroll}\n        outerRef={ref}\n        width=\"100%\"\n        ref={listRef}\n        itemCount={shapeLists.length}\n        itemData={shapeLists}\n        itemSize={getSize}\n      >\n        {render}\n      </VariableSizeList>\n      {gradient}\n      {footerShown && (\n        <Footer>\n          <Results>{resultsText}</Results>\n          {expandButton}\n        </Footer>\n      )}\n    </ChartLegendContainer>\n  );\n}\n\nconst Footer = styled.div`\n  width: 100%;\n  height: 50px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n`;\n\nconst ChartLegendContainer = styled(Container)`\n  flex-direction: column;\n  padding: 10px 0 0;\n  position: relative;\n  word-wrap: break-word;\n`;\n\nconst Results = styled.span(() => {\n  const theme = useContext(ChartThemeContext);\n\n  return css`\n    font: ${theme.legendResultsFont};\n    letter-spacing: ${theme.legendResultsLetterSpacing};\n    color: ${theme.legendResultsColor};\n  `;\n});\n","import { memo, useContext, useMemo, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport { ChartControls } from \"./ChartControls\";\nimport { ChartSizeContainerProvider } from \"../CoreChart\";\nimport { CoreChart } from \"../CoreChart\";\nimport { generate, SeriesSource, ShapeList } from \"../Mondrian\";\nimport { HEIGHT, MARGINS } from \"../CoreChart/constants\";\nimport type { Metric, ProviderEvent, Timeseries } from \"../providerTypes\";\nimport type { MetricsChartProps } from \"./types\";\nimport { TimeseriesLegend } from \"../TimeseriesLegend\";\nimport { useHandler } from \"../hooks\";\nimport { ChartThemeContext, defaultChartTheme } from \"../theme\";\nimport { Theme } from \"../chartThemeTypes\";\n\ntype GenericShapeList = ShapeList<SeriesSource, Metric | ProviderEvent | null>;\n\ntype TimeseriesShapeList = ShapeList<Timeseries, Metric>;\n\nexport function MetricsChart(props: MetricsChartProps) {\n  const chartTheme: Theme = useMemo(\n    () => ({\n      ...defaultChartTheme,\n      ...props.chartTheme,\n    }),\n    [props.chartTheme],\n  );\n\n  return (\n    <ChartThemeContext.Provider value={chartTheme}>\n      <StyledChartSizeContainerProvider\n        overrideHeight={HEIGHT}\n        marginTop={MARGINS.top}\n        marginRight={MARGINS.right}\n        marginBottom={MARGINS.bottom}\n        marginLeft={MARGINS.left}\n      >\n        <InnerMetricsChart {...props} />\n      </StyledChartSizeContainerProvider>\n    </ChartThemeContext.Provider>\n  );\n}\n\nconst InnerMetricsChart = memo(function InnerMetricsChart(\n  props: MetricsChartProps,\n) {\n  const {\n    areaGradientShown = true,\n    chartControlsShown = true,\n    customChartControls,\n    events,\n    graphType,\n    legendShown = true,\n    readOnly,\n    stackingControlsShown = true,\n    stackingType,\n    targetLatency,\n    timeRange,\n    timeseriesData,\n  } = props;\n\n  const chart = useMemo(\n    () =>\n      generate({\n        events: events ?? [],\n        graphType,\n        stackingType,\n        targetLatency,\n        timeRange,\n        timeseriesData,\n      }),\n    [events, graphType, stackingType, targetLatency, timeRange, timeseriesData],\n  );\n\n  const { eventColor, shapeListColors, targetLatencyColor } =\n    useContext(ChartThemeContext);\n\n  const [focusedShapeList, setFocusedShapeList] =\n    useState<GenericShapeList | null>(null);\n\n  const getShapeListColor = useMemo(() => {\n    return (source: SeriesSource, index: number): string => {\n      switch (source.type) {\n        case \"timeseries\":\n          return shapeListColors[index % shapeListColors.length];\n        case \"events\":\n          return eventColor;\n        case \"target_latency\":\n          return targetLatencyColor || \"transparent\";\n      }\n    };\n  }, [eventColor, shapeListColors, targetLatencyColor]);\n\n  const onFocusedShapeListChange = useHandler(\n    (shapeList: GenericShapeList | null) => {\n      if (!shapeList || isTimeseriesShapeList(shapeList)) {\n        setFocusedShapeList(shapeList);\n      }\n    },\n  );\n\n  return (\n    <>\n      {chartControlsShown && !readOnly && (\n        <ChartControls {...props} stackingControlsShown={stackingControlsShown}>\n          {customChartControls}\n        </ChartControls>\n      )}\n      <CoreChart\n        {...props}\n        areaGradientShown={areaGradientShown}\n        chart={chart}\n        focusedShapeList={focusedShapeList}\n        getShapeListColor={getShapeListColor}\n        onFocusedShapeListChange={onFocusedShapeListChange}\n      />\n      {legendShown && (\n        <TimeseriesLegend\n          {...props}\n          getShapeListColor={getShapeListColor}\n          onFocusedShapeListChange={onFocusedShapeListChange}\n          shapeLists={chart.shapeLists.filter(isTimeseriesShapeList)}\n        />\n      )}\n    </>\n  );\n});\n\nconst StyledChartSizeContainerProvider = styled(ChartSizeContainerProvider)`\n  display: flex;\n  gap: 12px;\n  flex-direction: column;\n`;\n\nfunction isTimeseriesShapeList(\n  shapeList: GenericShapeList,\n): shapeList is TimeseriesShapeList & { source: { type: \"timeseries\" } } {\n  return shapeList.source.type === \"timeseries\";\n}\n","import styled from \"styled-components\";\nimport { useMemo } from \"react\";\n\nimport {\n  ChartSizeContainerProvider,\n  CoreChart,\n  CoreChartProps,\n  TickFormatters,\n} from \"../CoreChart\";\nimport { Metric, Timeseries } from \"../providerTypes\";\nimport { TimeseriesSourceData, generateFromTimeseries } from \"../Mondrian\";\n\ntype Props = Pick<\n  CoreChartProps<Timeseries, Metric>,\n  \"onChangeTimeRange\" | \"areaGradientShown\"\n> &\n  Omit<TimeseriesSourceData, \"additionalValues\"> & {\n    /**\n     * Override the colors for the timeseries. If not specified several colors\n     * of the theme are used.\n     */\n    colors: Array<string>;\n  };\n\nexport function SparkChart({\n  areaGradientShown = false,\n  colors,\n  graphType,\n  stackingType,\n  timeRange,\n  timeseriesData,\n  onChangeTimeRange,\n}: Props) {\n  const chart = useMemo(\n    () =>\n      generateFromTimeseries({\n        graphType,\n        stackingType,\n        timeRange,\n        timeseriesData,\n        additionalValues: [],\n      }),\n    [graphType, stackingType, timeRange, timeseriesData],\n  );\n\n  const getShapeListColor = useMemo(() => {\n    return (_source: Timeseries, index: number): string =>\n      colors[index % colors.length];\n  }, [colors]);\n\n  return (\n    <StyledChartSizeContainerProvider>\n      <CoreChart\n        areaGradientShown={areaGradientShown}\n        chart={chart}\n        focusedShapeList={null}\n        getShapeListColor={getShapeListColor}\n        gridShown={false}\n        onChangeTimeRange={onChangeTimeRange}\n        tickFormatters={tickFormatters}\n        timeRange={timeRange}\n      />\n    </StyledChartSizeContainerProvider>\n  );\n}\n\nconst StyledChartSizeContainerProvider = styled(ChartSizeContainerProvider)`\n  width: 100%;\n  height: 100%;\n`;\n\n// Dummy formatters, since we don't display axes in a spark chart anyway.\nconst tickFormatters: TickFormatters = {\n  xFormatter: () => \"\",\n  yFormatter: () => \"\",\n};\n","import type { Axis } from \"./Mondrian\";\n\nexport type FormatterKind =\n  /**\n   * Formats a number of bytes.\n   *\n   * ## Examples\n   *\n   * `0.1B`, `10B`, `10kB`.\n   */\n  | \"bytes\"\n\n  /**\n   * Formats a duration expressed in seconds.\n   *\n   * ## Examples\n   *\n   * `0.1s`, `10s`, `2h47`.\n   */\n  | \"duration\"\n\n  /**\n   * Formats a value with an optional exponent component, also referred to as\n   * \"E notation\".\n   *\n   * ## Examples\n   *\n   * `0.1`, `10`, `1.0e4`.\n   */\n  | \"exponent\"\n\n  /**\n   * Formats a percentage value.\n   *\n   * ## Examples\n   *\n   * `0.1%`, `10%`, `10000%`.\n   */\n  | \"percentage\"\n\n  /**\n   * Formats a value using scientific notation.\n   *\n   * ## Examples\n   *\n   * `100m`, `10`, `10k`.\n   */\n  | \"scientific\"\n\n  /**\n   * Formats a time stamp expressed in seconds since the UNIX epoch.\n   *\n   * For brevity, the formatter omits the most significant parts of the time\n   * that are constant across the axis.\n   *\n   * Currently, only UTC formatting is supported.\n   *\n   * ## Examples\n   *\n   * `Fri 13`, `17:15`, `57.200`\n   */\n  | \"time\";\n\nexport type TickFormatter = (value: number) => string;\n\nexport function getFormatterForAxis(\n  axis: Axis,\n  kind: FormatterKind,\n): TickFormatter {\n  switch (kind) {\n    case \"bytes\":\n      return getBytesFormatterForAxis(axis);\n    case \"duration\":\n      return getDurationFormatterForAxis(axis);\n    case \"exponent\":\n      return getExponentFormatter();\n    case \"percentage\":\n      return getPercentageFormatter();\n    case \"scientific\":\n      return getScientificFormatterForAxis(axis);\n    case \"time\":\n      return getTimeFormatterForAxis(axis);\n  }\n}\n\nexport function getBytesFormatterForAxis(axis: Axis): TickFormatter {\n  const largestUnit = ScientificUnit.forValue(axis.maxValue);\n  const minimumUnit = ScientificUnit.None;\n  const scientificFormatter = getScientificFormatterForUnits(\n    largestUnit,\n    minimumUnit,\n  );\n\n  return (value: number): string => {\n    return `${scientificFormatter(value)}B`;\n  };\n}\n\nexport function getDurationFormatterForAxis(axis: Axis): TickFormatter {\n  const largestUnit = DurationUnit.forValue(axis.maxValue);\n\n  return (value: number): string => {\n    let unit = largestUnit;\n    let adjusted = value * unit.multiplier();\n    while (Math.abs(adjusted) < 1) {\n      const nextUnitWithAmount = unit.nextLargest();\n      if (nextUnitWithAmount) {\n        adjusted *= nextUnitWithAmount[0];\n        unit = nextUnitWithAmount[1];\n      } else {\n        break;\n      }\n    }\n\n    if (Math.abs(adjusted) >= 10) {\n      return `${adjusted.toFixed(1)}${unit}`;\n    }\n\n    const nextUnitWithAmount = unit.nextLargest();\n    if (nextUnitWithAmount) {\n      const first = Math.floor(adjusted);\n      const second = Math.round((adjusted - first) * nextUnitWithAmount[0]);\n      const nextUnit = nextUnitWithAmount[1];\n      return `${first}${unit}${second}${nextUnit}`;\n    }\n\n    // unit must be seconds (or smaller)\n    const formatter = getScientificFormatterForUnits(\n      ScientificUnit.None,\n      ScientificUnit.Pico,\n    );\n    return `${formatter(adjusted)}s`;\n  };\n}\n\nexport function getExponentFormatter(): TickFormatter {\n  return (value: number): string => {\n    const absoluteValue = Math.abs(value);\n    if (absoluteValue >= 10000) {\n      let adjusted = value * 0.0001;\n      let exponent = 4;\n      while (Math.abs(adjusted) > 10) {\n        adjusted *= 0.1;\n        exponent += 1;\n      }\n\n      return `${adjusted.toFixed(1)}e${exponent}`;\n    } else if (absoluteValue < Number.EPSILON) {\n      return \"0\";\n    } else if (absoluteValue < 0.01) {\n      let adjusted = value * 1000;\n      let exponent = -3;\n      while (Math.abs(adjusted) < 1) {\n        adjusted *= 10;\n        exponent -= 1;\n      }\n\n      return `${adjusted.toFixed(1)}e${exponent}`;\n    } else if (absoluteValue < 0.1) {\n      return value.toFixed(2);\n    } else if (value === Math.round(value)) {\n      return value.toString();\n    } else {\n      return value.toFixed(1);\n    }\n  };\n}\n\nexport function getPercentageFormatter(): TickFormatter {\n  return (value: number): string => {\n    const percentageValue = value * 100;\n    if (percentageValue === Math.round(percentageValue)) {\n      return `${percentageValue}%`;\n    } else {\n      return `${percentageValue.toFixed(1)}%`;\n    }\n  };\n}\n\nexport function getScientificFormatterForAxis(axis: Axis): TickFormatter {\n  const largestUnit = ScientificUnit.forValue(axis.maxValue);\n  let minimumUnit = ScientificUnit.forValue(axis.minValue);\n\n  // It just looks awkward if we go into too much detail on an axis that\n  // also has large numbers.\n  if (\n    largestUnit.isBiggerThan(ScientificUnit.None) &&\n    minimumUnit.isSmallerThan(ScientificUnit.None)\n  ) {\n    minimumUnit = ScientificUnit.None;\n  }\n\n  return getScientificFormatterForUnits(largestUnit, minimumUnit);\n}\n\nfunction getScientificFormatterForUnits(\n  largestUnit: ScientificUnit,\n  minimumUnit: ScientificUnit,\n): TickFormatter {\n  return (value: number): string => {\n    let unit = largestUnit;\n    let adjusted = value * unit.multiplier();\n    while (Math.abs(adjusted) < 0.05 && unit.isBiggerThan(minimumUnit)) {\n      const nextUnit = unit.nextLargest();\n      if (nextUnit) {\n        unit = nextUnit;\n      } else {\n        break;\n      }\n\n      adjusted *= 1000;\n    }\n\n    if (Math.abs(adjusted) === 0) {\n      return \"0\";\n    } else if (adjusted >= 10 || adjusted === Math.round(adjusted)) {\n      return `${adjusted.toFixed(0)}${unit}`; // avoid unnecessary `.0` suffix\n    } else {\n      return `${adjusted.toFixed(1)}${unit}`;\n    }\n  };\n}\n\nconst WEEKDAYS = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n\nexport function getTimeFormatterForAxis(axis: Axis): TickFormatter {\n  const scale = getTimeScaleForAxis(axis);\n\n  return (value: number): string => {\n    const date = new Date(value * 1000);\n    if (Number.isNaN(date.getTime())) {\n      return \"-\";\n    }\n\n    switch (scale) {\n      case \"day_in_month\":\n        return `${WEEKDAYS[date.getUTCDay()]} ${date.getUTCDate()}`;\n\n      case \"day_in_week\":\n        return `${WEEKDAYS[date.getUTCDay()]} ${date.getUTCHours()}h`;\n\n      case \"hours\":\n        return `${date.getUTCHours()}:${date\n          .getUTCMinutes()\n          .toString()\n          .padStart(2, \"0\")}`;\n\n      case \"minutes\":\n        return `${date.getUTCHours()}:${date\n          .getUTCMinutes()\n          .toString()\n          .padStart(2, \"0\")}:${date\n          .getUTCSeconds()\n          .toString()\n          .padStart(2, \"0\")}`;\n\n      case \"seconds\":\n        return `${date.getUTCSeconds()}.${date\n          .getUTCMilliseconds()\n          .toString()\n          .padStart(3, \"0\")}`;\n\n      case \"milliseconds\":\n        return `.${date.getUTCMilliseconds().toString().padStart(3, \"0\")}`;\n    }\n  };\n}\n\nclass DurationUnit {\n  static Days = new DurationUnit(\"days\");\n  static Hours = new DurationUnit(\"hours\");\n  static Minutes = new DurationUnit(\"minutes\");\n  static Seconds = new DurationUnit(\"seconds\");\n\n  /**\n   * Returns the most appropriate unit to use for formatting the given\n   * duration, without assuming any other context.\n   */\n  static forValue(value: number): DurationUnit {\n    if (value >= 24 * 3600) {\n      return DurationUnit.Days;\n    } else if (value >= 3600) {\n      return DurationUnit.Hours;\n    } else if (value >= 60) {\n      return DurationUnit.Minutes;\n    } else {\n      return DurationUnit.Seconds;\n    }\n  }\n\n  constructor(private unit: \"days\" | \"hours\" | \"minutes\" | \"seconds\") {}\n\n  /**\n   * The multiplier to apply to a duration if it is to be formatted with this\n   * unit.\n   */\n  multiplier(): number {\n    switch (this.unit) {\n      case \"days\":\n        return 1 / (24 * 3600);\n      case \"hours\":\n        return 1 / 3600;\n      case \"minutes\":\n        return 1 / 60;\n      case \"seconds\":\n        return 1;\n    }\n  }\n\n  /**\n   * Returns the next largest unit smaller than this unit, as well as the\n   * amount of that unit that fit into this unit, if any.\n   */\n  nextLargest(): [amount: number, unit: DurationUnit] | null {\n    switch (this.unit) {\n      case \"days\":\n        return [24, DurationUnit.Hours];\n      case \"hours\":\n        return [60, DurationUnit.Minutes];\n      case \"minutes\":\n        return [60, DurationUnit.Seconds];\n      case \"seconds\":\n        return null;\n    }\n  }\n\n  toString(): string {\n    switch (this.unit) {\n      case \"days\":\n        return \"d\";\n      case \"hours\":\n        return \"h\";\n      case \"minutes\":\n        return \"m\";\n      case \"seconds\":\n        return \"s\";\n    }\n  }\n}\n\nclass ScientificUnit {\n  static Tera = new ScientificUnit(4);\n  static Giga = new ScientificUnit(3);\n  static Mega = new ScientificUnit(2);\n  static Kilo = new ScientificUnit(1);\n  static None = new ScientificUnit(0);\n  static Milli = new ScientificUnit(-1);\n  static Micro = new ScientificUnit(-2);\n  static Nano = new ScientificUnit(-3);\n  static Pico = new ScientificUnit(-4);\n\n  constructor(private step: number) {}\n\n  /**\n   * Returns the most appropriate unit to use for formatting the given\n   * value, without assuming any other context.\n   */\n  static forValue(value: number): ScientificUnit {\n    if (value >= 1e12) {\n      return ScientificUnit.Tera;\n    } else if (value >= 1e9) {\n      return ScientificUnit.Giga;\n    } else if (value >= 1e6) {\n      return ScientificUnit.Mega;\n    } else if (value >= 1e3) {\n      return ScientificUnit.Kilo;\n    } else if (value >= 1e3) {\n      return ScientificUnit.Kilo;\n    } else if (value >= 1) {\n      return ScientificUnit.None;\n    } else if (value >= 1e-3) {\n      return ScientificUnit.Milli;\n    } else if (value >= 1e-6) {\n      return ScientificUnit.Micro;\n    } else if (value >= 1e-9) {\n      return ScientificUnit.Nano;\n    } else {\n      return ScientificUnit.Pico;\n    }\n  }\n\n  isBiggerThan(other: ScientificUnit): boolean {\n    return this.step > other.step;\n  }\n\n  isSmallerThan(other: ScientificUnit): boolean {\n    return this.step < other.step;\n  }\n\n  /**\n   * The multiplier to apply to a value if it is to be formatted with this\n   * unit.\n   */\n  multiplier(): number {\n    switch (this.step) {\n      case 4:\n        return 1e-12;\n      case 3:\n        return 1e-9;\n      case 2:\n        return 1e-6;\n      case 1:\n        return 1e-3;\n      case 0:\n        return 1;\n      case -1:\n        return 1e3;\n      case -2:\n        return 1e6;\n      case -3:\n        return 1e9;\n      case -4:\n        return 1e12;\n      default:\n        throw new Error(`Unsupported step: ${this.step}`);\n    }\n  }\n\n  /**\n   * Returns the next largest unit smaller than this unit, if any.\n   */\n  nextLargest(): ScientificUnit | null {\n    if (this.step > -4) {\n      return new ScientificUnit(this.step - 1);\n    } else {\n      return null;\n    }\n  }\n\n  toString(): string {\n    switch (this.step) {\n      case 4:\n        return \"T\";\n      case 3:\n        return \"G\";\n      case 2:\n        return \"M\";\n      case 1:\n        return \"k\";\n      case 0:\n        return \"\";\n      case -1:\n        return \"m\";\n      case -2:\n        return \"μ\";\n      case -3:\n        return \"n\";\n      case -4:\n        return \"p\";\n      default:\n        throw new Error(`Unsupported step: ${this.step}`);\n    }\n  }\n}\n\ntype TimeScale =\n  | \"day_in_month\"\n  | \"day_in_week\"\n  | \"hours\"\n  | \"minutes\"\n  | \"seconds\"\n  | \"milliseconds\";\n\nfunction getTimeScaleForAxis(axis: Axis): TimeScale {\n  const delta = Math.abs(axis.maxValue - axis.minValue);\n  if (delta > 10 * 24 * 3600) {\n    return \"day_in_month\";\n  } else if (delta > 24 * 3600) {\n    return \"day_in_week\";\n  } else if (delta > 3600) {\n    return \"hours\";\n  } else if (delta > 60) {\n    return \"minutes\";\n  } else if (delta > 1) {\n    return \"seconds\";\n  } else {\n    return \"milliseconds\";\n  }\n}\n"],"names":["defaultChartTheme","axisColor","axisFontFamily","axisFontSize","axisFontStyle","axisFontWeight","axisLetterSpacing","buttonActiveBackgroundColor","buttonActiveColor","buttonBackgroundColor","buttonBorderRadius","buttonColor","buttonDisabledBackgroundColor","buttonDisabledColor","buttonFocusBackgroundColor","buttonFocusBorderColor","buttonFocusColor","buttonFocusOutline","buttonFont","buttonGroupBackgroundColor","buttonGroupBorderRadius","buttonHoverBackgroundColor","buttonHoverColor","eventColor","expandableGradientColor","gridStrokeColor","legendItemBorderRadius","legendItemCheckboxBorderRadius","legendItemCheckboxColor","legendItemColor","legendItemEmphasisBackgroundColor","legendItemEmphasisBorderRadius","legendItemEmphasisColor","legendItemEmphasisFont","legendItemFont","legendItemOnHoverBackgroundColor","legendItemOnHoverColor","legendResultsColor","legendResultsFont","legendResultsLetterSpacing","shapeListColors","targetLatencyColor","ChartThemeContext","createContext","ButtonGroup","styled","span","theme","useContext","css","Box","div","Container","ControlsContainer","ControlsGroup","ControlsSet","ControlsSetLabel","_path","_extends","ICON_MAP","chart_bar","ChartBarIcon","chart_line","ChartLineIcon","check","CheckIcon","combined","CombinedIcon","percentage","PercentageIcon","stacked","StackedIcon","triangle_down","TriangleDownIcon","Icon","type","svgProps","Component","_jsx","buttonStyling","StyledButton","button","buttonSize","padding","width","height","iconSize","IconButton","forwardRef","props","ref","className","style","active","children","otherProps","newStyle","elementProps","compact","items","filter","Boolean","findUniqueKeys","timeseriesData","constantKeys","detectedValues","timeseries","keys","Object","labels","undefined","Set","key","delete","allKeys","has","identity","input","mergeRefs","refs","value","current","noop","preventDefault","event","sortBy","array","getPriorityFn","reverse","sort","a","b","priorityA","priorityB","secondsToTimestamp","seconds","Date","toISOString","timestampToSeconds","timestamp","getTime","os","navigator","platform","match","toLowerCase","isMac","ChartControls","graphType","onChangeGraphType","onChangeStackingType","stackingControlsShown","stackingType","_jsxs","aria-label","onClick","ChartSizeContext","xMax","yMax","marginTop","marginRight","marginBottom","marginLeft","noDeps","useHandler","handler","handlerRef","useRef","useCallback","args","useExpandable","defaultHeight","showExpandButton","setShowExpandButton","useState","isExpanded","setIsExpanded","showGradient","setShowGradient","update","element","scrollTop","scrollHeight","clientHeight","asyncUpdate","setTimeout","useEffect","unsubscribeFromNode","setRef","node","subscribeToNode","onClickExpand","expandButton","Expand","revert","gradient","GradientContainer","Gradient","onScroll","listenerMap","WeakMap","observer","observerCallback","entries","entry","listeners","get","target","listener","add","set","ResizeObserver","observe","size","unobserve","reducer","counter","useForceUpdate","forceUpdate","useReducer","noEntries","useIntersectionObserver","options","intersections","setIntersections","IntersectionObserver","disconnect","defaultDimensions","useMeasure","setElement","rect","setRect","useMemo","window","contentRect","useLayoutEffect","ChartSizeContainerProvider","overrideHeight","measureRef","measuredHeight","intersectionRef","intersectionOptions","setValue","updateValue","debounce","some","intersection","isIntersecting","Provider","ChartSkeleton","root","rootMargin","threshold","toFactory","coordinate","constantFactory","createAreaPathDef","data","coordinates","len","length","x","y0","y1","start","path","toFixed","i","next","previous","createLinePathDef","y","AreaShape","memo","anyFocused","areaGradientShown","area","color","focused","scales","id","useId","gradientId","gradientRef","point","xScale","yScale","yMin","g","opacity","defs","linearGradient","x1","x2","y2","stop","offset","stopColor","stopOpacity","d","points","stroke","strokeDasharray","join","strokeWidth","fill","LineShape","line","HEIGHT","MARGINS","top","bottom","left","right","POINT_RADIUS","POINT_RADIUS_FOCUSED","CHART_SHAPE_OVERFLOW_MARGIN","PointShape","circle","cx","cy","r","RectangleShape","rectangle","fillOpacity","ChartShape","shape","ChartContent","chart","focusedShapeList","getShapeListColor","_Fragment","shapeLists","flatMap","shapeList","listIndex","shapes","map","shapeIndex","source","LABEL_OFFSET","BottomAxis","formatter","strokeColor","ticks","xAxis","maxValue","minValue","transform","time","index","text","dy","fontFamily","fontStyle","fontWeight","fontSize","letterSpacing","textAnchor","createLinearScaleForRange","from","to","getCoordinatesForEvent","svg","getTarget","getBoundingClientRect","clientX","clientY","currentTarget","SVGSVGElement","parentElement","GridColumns","xTicks","lineProps","GridRows","yTicks","LeftAxis","gridBordersShown","tickLabelProps","dx","numTicks","valueOf","GridWithAxes","gridColumnsShown","gridRowsShown","gridDasharray","tickFormatters","yAxis","useCustomSpring","animatedScale","createLinearScaleForRangeWithCustomDomain","getTicks","getMaxXTickValue","getMaxYTickValue","xFormatter","yFormatter","range","min","max","linearScale","axis","scale","getMaxAllowedTick","suggestions","tickSuggestions","interval","getTicksAndIntervalFromSuggestions","getTicksAndIntervalFromRange","extendTicksToFitAxis","removeLastTickIfTooCloseToMax","Number","EPSILON","tick","push","suggestionInterval","axisRange","ticksPerRange","divisionFactor","Math","ceil","maxTicks","scaleToAxis","shift","preTick","unshift","postTick","spring","duration","easings","motionValue","useMotionValue","setCurrent","on","controls","animate","maxTickValue","lastTick","pop","defaultState","mouseInteraction","dragKeyPressed","zoomKeyPressed","useInteractiveControls","readOnly","state","dispatch","controlsStateReducer","createControls","resetMouseInteraction","startDrag","payload","startZoom","updateEndValue","end","updatePressedKeys","action","shiftKey","metaKey","ctrlKey","MIN_DURATION","useMouseControls","interactiveControls","timeRange","onChangeTimeRange","dimensions","onMouseDown","buttons","coords","onMouseMove","onMouseUp","coordinateToTimestamp","move","onWheel","factor","deltaY","zoom","deltaRatio","currentFrom","currentTo","delta","focusRatio","focusTimestamp","newDuration","useScales","translatedRange","useTooltip","graphTooltip","setGraphTooltip","closeFnRef","showTooltipFn","showTooltip","tip","ctm","getScreenCTM","createSVGPoint","matrixTransform","DOMRect","contextElement","sourcePoint","closeTooltip","closest","getClosestSeriesAndPointWithCoordinates","series","shapeListIndex","findIndex","onMouseLeave","closestSeriesAndPoint","closestDistance","Infinity","getClosestPointWithDistance","closestCoords","distance","isCloser","getClosestPointWithDistanceForArea","getClosestPointWithDistanceForLine","getDistance","getClosestPointWithDistanceForRectangle","horizontalDistance","abs","verticalDistance","closestPoint","horizontal","vertical","p1","p2","reference","ZoomBar","reverseZoom","CoreChart","gridShown","onMouseMoveControls","onMouseMoveTooltip","modifierPressed","clipPathId","cursor","getCursorFromState","wheelListenerOptions","passive","addEventListener","removeEventListener","clipPathYStart","clipPathHeight","svgHeight","clipPath","pointerEvents","getTimeFromTimestamp","isNaN","TypeError","attachSuggestionsToXAxis","buckets","firstBucketTime","getFirstBucketTime","suggestion","firstBucketTimestamp","BAR_PADDING","BAR_PLUS_PADDING","calculateBarWidth","numBarsPerGroup","numGroups","round","numBars","HALF_PADDING","calculateBarX","groupX","barWidth","barIndex","numShapeLists","extendMinMax","minMax","getInitialMinMax","getYAxisForConstantValue","calculateStackedYAxisRange","getTotalValue","values","createMetricBuckets","initialValue","Map","visible","metrics","getXAxisFromTimeRange","calculateBucketsAndAxesForStackedChart","currentY","total","isPercentage","calculateSmallestTimeInterval","timestamps","Array","smallestInterval","calculateYAxisRange","getMinMax","getBucketsMinMax","margin","bucketMinMax","extendAxisWithInterval","halfInterval","extendAxisWithValue","normalizeAlongLinearAxis","splitIntoContinuousLines","lines","currentLine","previousTime","metric","newTime","generateBarChartFromTimeseries","visibleTimeseriesData","maybeMinMax","additionalValues","barArgs","getBarShape","indexOf","numVisibleTimeseries","generateLineChartFromTimeseries","getShapes","getPointForMetric","generateShapeListFromEvents","events","generateShapeListFromTargetLatency","generateStackedBarChartFromTimeseries","bucketValue","generateStackedLineChartFromTimeseries","axesAndBuckets","generate","targetLatency","timeseriesChart","generateFromTimeseries","list","TimeseriesLegendItem","onHover","onToggleTimeseriesVisibility","setSize","uniqueKeys","toggleTimeseriesVisibility","toggleSingle","toggleOthers","onKeyDown","chartTheme","LegendItemContainer","$chartTheme","onMouseOver","interactive","ColorBlock","selected","FormattedTimeseries","emphasizedKeys","name","labelEntries","Text","Fragment","includes","Emphasis","DEFAULT_HEIGHT","DEFAULT_SIZE","EXPANDED_HEIGHT","TimeseriesLegend","footerShown","onFocusedShapeListChange","maxHeight","numSeries","resultsText","listRef","sizeMap","heightRef","getSize","oldSize","resetAfterIndex","onMouseOut","setFocusedTimeseries","find","render","ChartLegendContainer","VariableSizeList","estimatedItemSize","outerRef","itemCount","itemData","itemSize","Footer","Results","MetricsChart","StyledChartSizeContainerProvider","InnerMetricsChart","chartControlsShown","customChartControls","legendShown","setFocusedShapeList","isTimeseriesShapeList","SparkChart","colors","_source","getFormatterForAxis","kind","getBytesFormatterForAxis","getDurationFormatterForAxis","getExponentFormatter","getPercentageFormatter","getScientificFormatterForAxis","getTimeFormatterForAxis","largestUnit","ScientificUnit","forValue","minimumUnit","None","scientificFormatter","getScientificFormatterForUnits","DurationUnit","unit","adjusted","multiplier","nextUnitWithAmount","nextLargest","first","floor","second","nextUnit","Pico","absoluteValue","exponent","toString","percentageValue","isBiggerThan","isSmallerThan","WEEKDAYS","getTimeScaleForAxis","date","getUTCDay","getUTCDate","getUTCHours","getUTCMinutes","padStart","getUTCSeconds","getUTCMilliseconds","Days","Hours","Minutes","Seconds","constructor","Tera","Giga","Mega","Kilo","Milli","Micro","Nano","other","step","Error"],"mappings":"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"}